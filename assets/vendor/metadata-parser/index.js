function makeUrlAbsolute(t,e){return new URL(e,t).href}function parseUrl(t){return new URL(t).host}function getProvider(t){return t.replace(/www[a-zA-Z0-9]*\./,"").replace(".co.",".").split(".").slice(0,-1).join(" ")}function buildRuleSet(t){return(e,r)=>{let o,i=0;for(let r=0;r<t.rules.length;r++){const[l,n]=t.rules[r],u=Array.from(e.querySelectorAll(l));if(u.length)for(const e of u){let l=t.rules.length-r;if(t.scorers)for(const r of t.scorers){const t=r(e,l);t&&(l=t)}l>i&&(i=l,o=n(e))}}if(!o&&t.defaultValue&&(o=t.defaultValue(r)),o){if(t.processors)for(const e of t.processors)o=e(o,r);return o.trim&&(o=o.trim()),o}}}const metadataRuleSets={description:{rules:[['meta[property="og:description"]',t=>t.getAttribute("content")],['meta[name="description"]',t=>t.getAttribute("content")]]},icon:{rules:[['link[rel="apple-touch-icon"]',t=>t.getAttribute("href")],['link[rel="apple-touch-icon-precomposed"]',t=>t.getAttribute("href")],['link[rel="fluid-icon"]',t=>t.getAttribute("href")],['link[rel="shortcut icon"]',t=>t.getAttribute("href")],['link[rel="Shortcut Icon"]',t=>t.getAttribute("href")],['link[rel="mask-icon"]',t=>t.getAttribute("href")],['link[rel="icon"]',t=>t.getAttribute("href")]],scorers:[(t,e)=>{const r=t.getAttribute("sizes");if(r){const t=r.match(/\d+/g);if(t)return t.reduce(((t,e)=>t*e))}}],defaultValue:t=>"favicon.ico",processors:[(t,e)=>makeUrlAbsolute(e.url,t)]},image:{rules:[['meta[property="og:image:secure_url"]',t=>t.getAttribute("content")],['meta[property="og:image:url"]',t=>t.getAttribute("content")],['meta[property="og:image"]',t=>t.getAttribute("content")],['meta[name="twitter:image"]',t=>t.getAttribute("content")],['meta[property="twitter:image"]',t=>t.getAttribute("content")],['meta[name="thumbnail"]',t=>t.getAttribute("content")]],processors:[(t,e)=>makeUrlAbsolute(e.url,t)]},keywords:{rules:[['meta[name="keywords"]',t=>t.getAttribute("content")]],processors:[(t,e)=>t.split(",").map((t=>t.trim()))]},title:{rules:[['meta[property="og:title"]',t=>t.getAttribute("content")],['meta[name="twitter:title"]',t=>t.getAttribute("content")],['meta[property="twitter:title"]',t=>t.getAttribute("content")],['meta[name="hdl"]',t=>t.getAttribute("content")],["title",t=>t.text]]},type:{rules:[['meta[property="og:type"]',t=>t.getAttribute("content")]]},url:{rules:[["a.amp-canurl",t=>t.getAttribute("href")],['link[rel="canonical"]',t=>t.getAttribute("href")],['meta[property="og:url"]',t=>t.getAttribute("content")]],defaultValue:t=>t.url,processors:[(t,e)=>makeUrlAbsolute(e.url,t)]},provider:{rules:[['meta[property="og:site_name"]',t=>t.getAttribute("content")]],defaultValue:t=>getProvider(parseUrl(t.url))}};function getMetadata(t,e,r){const o={},i={url:e},l=r||metadataRuleSets;return Object.keys(l).map((e=>{const r=buildRuleSet(l[e]);o[e]=r(t,i)})),o}module.exports={buildRuleSet,getMetadata,getProvider,metadataRuleSets};