/*!
 * MIT License
 * 
 * Copyright (c) Peculiar Ventures. All rights reserved.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
var x509=function(e){"use strict";var t,r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  	THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  	See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */!function(e){!function(t){var i="object"==typeof r?r:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=s(e);function s(e,t){return function(r,i){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0===i.Reflect?i.Reflect=e:n=s(i.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",n=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,o={__proto__:[]}instanceof Array,a=!s&&!o,c={create:s?function(){return ie(Object.create(null))}:o?function(){return ie({__proto__:null})}:function(){return ie({})},has:a?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:a?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),l="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,p=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(l||"function"!=typeof WeakMap?re():WeakMap);function y(e,t,r,i){if(P(r)){if(!z(e))throw new TypeError;if(!q(t))throw new TypeError;return k(e,t)}if(!z(e))throw new TypeError;if(!L(t))throw new TypeError;if(!L(i)&&!P(i)&&!V(i))throw new TypeError;return V(i)&&(i=void 0),x(e,t,r=F(r),i)}function d(e,t){function r(r,i){if(!L(r))throw new TypeError;if(!P(i)&&!G(i))throw new TypeError;T(e,t,r,i)}return r}function g(e,t,r,i){if(!L(r))throw new TypeError;return P(i)||(i=F(i)),T(e,t,r,i)}function v(e,t,r){if(!L(t))throw new TypeError;return P(r)||(r=F(r)),C(e,t,r)}function m(e,t,r){if(!L(t))throw new TypeError;return P(r)||(r=F(r)),E(e,t,r)}function w(e,t,r){if(!L(t))throw new TypeError;return P(r)||(r=F(r)),N(e,t,r)}function b(e,t,r){if(!L(t))throw new TypeError;return P(r)||(r=F(r)),O(e,t,r)}function A(e,t){if(!L(e))throw new TypeError;return P(t)||(t=F(t)),U(e,t)}function S(e,t){if(!L(e))throw new TypeError;return P(t)||(t=F(t)),j(e,t)}function B(e,t,r){if(!L(t))throw new TypeError;P(r)||(r=F(r));var i=I(t,r,!1);if(P(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var n=f.get(t);return n.delete(r),n.size>0||f.delete(t),!0}function k(e,t){for(var r=e.length-1;r>=0;--r){var i=(0,e[r])(t);if(!P(i)&&!V(i)){if(!q(i))throw new TypeError;t=i}}return t}function x(e,t,r,i){for(var n=e.length-1;n>=0;--n){var s=(0,e[n])(t,r,i);if(!P(s)&&!V(s)){if(!L(s))throw new TypeError;i=s}}return i}function I(e,t,r){var i=f.get(e);if(P(i)){if(!r)return;i=new p,f.set(e,i)}var n=i.get(t);if(P(n)){if(!r)return;n=new p,i.set(t,n)}return n}function C(e,t,r){if(E(e,t,r))return!0;var i=Q(t);return!V(i)&&C(e,i,r)}function E(e,t,r){var i=I(t,r,!1);return!P(i)&&$(i.has(e))}function N(e,t,r){if(E(e,t,r))return O(e,t,r);var i=Q(t);return V(i)?void 0:N(e,i,r)}function O(e,t,r){var i=I(t,r,!1);if(!P(i))return i.get(e)}function T(e,t,r,i){I(r,i,!0).set(e,t)}function U(e,t){var r=j(e,t),i=Q(e);if(null===i)return r;var n=U(i,t);if(n.length<=0)return r;if(r.length<=0)return n;for(var s=new h,o=[],a=0,c=r;a<c.length;a++){var u=c[a];s.has(u)||(s.add(u),o.push(u))}for(var l=0,p=n;l<p.length;l++){u=p[l];s.has(u)||(s.add(u),o.push(u))}return o}function j(e,t){var r=[],i=I(e,t,!1);if(P(i))return r;for(var n=W(i.keys()),s=0;;){var o=Y(n);if(!o)return r.length=s,r;var a=Z(o);try{r[s]=a}catch(e){try{X(n)}finally{throw e}}s++}}function R(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function P(e){return void 0===e}function V(e){return null===e}function H(e){return"symbol"==typeof e}function L(e){return"object"==typeof e?null!==e:"function"==typeof e}function D(e,t){switch(R(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=J(e,i);if(void 0!==n){var s=n.call(e,r);if(L(s))throw new TypeError;return s}return M(e,"default"===r?"number":r)}function M(e,t){if("string"===t){var r=e.toString;if(K(r))if(!L(n=r.call(e)))return n;if(K(i=e.valueOf))if(!L(n=i.call(e)))return n}else{var i;if(K(i=e.valueOf))if(!L(n=i.call(e)))return n;var n,s=e.toString;if(K(s))if(!L(n=s.call(e)))return n}throw new TypeError}function $(e){return!!e}function _(e){return""+e}function F(e){var t=D(e,3);return H(t)?t:_(t)}function z(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function K(e){return"function"==typeof e}function q(e){return"function"==typeof e}function G(e){switch(R(e)){case 3:case 4:return!0;default:return!1}}function J(e,t){var r=e[t];if(null!=r){if(!K(r))throw new TypeError;return r}}function W(e){var t=J(e,n);if(!K(t))throw new TypeError;var r=t.call(e);if(!L(r))throw new TypeError;return r}function Z(e){return e.value}function Y(e){var t=e.next();return!t.done&&t}function X(e){var t=e.return;t&&t.call(e)}function Q(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[n]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,i)},t.prototype.values=function(){return new r(this._keys,this._values,s)},t.prototype.entries=function(){return new r(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[n]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function s(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new p}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[n]=function(){return this.keys()},e}()}function re(){var e=16,r=c.create(),i=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=s(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=s(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return s(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=s(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var e;do{e="@@WeakMap@@"+u()}while(c.has(r,e));return r[e]=!0,e}function s(e,r){if(!t.call(e,i)){if(!r)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",i=0;i<e;++i){var n=t[i];4!==i&&6!==i&&8!==i||(r+="-"),n<16&&(r+="0"),r+=n.toString(16).toLowerCase()}return r}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",y),e("metadata",d),e("defineMetadata",g),e("hasMetadata",v),e("hasOwnMetadata",m),e("getMetadata",w),e("getOwnMetadata",b),e("getMetadataKeys",A),e("getOwnMetadataKeys",S),e("deleteMetadata",B)}(n)}()}(t||(t={}));class i{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e).slice().buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=i.toUint8Array(e),n=i.toUint8Array(t);if(r.length!==n.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}static concat(...e){if(Array.isArray(e[0])){const t=e[0];let r=0;for(const e of t)r+=e.byteLength;const i=new Uint8Array(r);let n=0;for(const e of t){const t=this.toUint8Array(e);i.set(t,n),n+=t.length}return e[1]?this.toView(i,e[1]):i.buffer}return this.concat(e)}}class n{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=i.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class s{static toString(e,t=!1){const r=i.toArrayBuffer(e),n=new DataView(r);let s="";for(let e=0;e<r.byteLength;e+=2){const r=n.getUint16(e,t);s+=String.fromCharCode(r)}return s}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),i=new DataView(r);for(let r=0;r<e.length;r++)i.setUint16(2*r,e.charCodeAt(r),t);return r}}class o{static isHex(e){return"string"==typeof e&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return"string"==typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return"string"==typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t){const r=i.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return s.toString(r,!0);case"utf16":case"utf16be":return s.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return s.fromString(e,!0);case"utf16":case"utf16be":return s.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=i.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!o.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!o.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=o.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return n.fromString(e);case"utf16":case"utf16be":return s.fromString(e);case"utf16le":case"usc2":return s.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=o.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return n.toString(e);case"utf16":case"utf16be":return s.toString(e);case"utf16le":case"usc2":return s.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);return r.buffer}static ToBinary(e){const t=i.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){const t=i.toUint8Array(e),r=[],n=t.length;for(let e=0;e<n;e++){const i=t[e].toString(16).padStart(2,"0");r.push(i)}return r.join("")}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!o.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const i=t.slice(e,e+2);r[e/2]=parseInt(i,16)}return r.buffer}static ToUtf16String(e,t=!1){return s.toString(e,t)}static FromUtf16String(e,t=!1){return s.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function a(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}
/*!
   Copyright (c) Peculiar Ventures, LLC
  */function c(e,t){let r=0;if(1===e.length)return e[0];for(let i=e.length-1;i>=0;i--)r+=e[e.length-1-i]*Math.pow(2,t*i);return r}function u(e,t,r=-1){const i=r;let n=e,s=0,o=Math.pow(2,t);for(let r=1;r<8;r++){if(e<o){let e;if(i<0)e=new ArrayBuffer(r),s=r;else{if(i<r)return new ArrayBuffer(0);e=new ArrayBuffer(i),s=i}const o=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);o[s-e-1]=Math.floor(n/r),n-=o[s-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function l(...e){let t=0,r=0;for(const r of e)t+=r.length;const i=new ArrayBuffer(t),n=new Uint8Array(i);for(const t of e)n.set(t,r),r+=t.length;return n}function p(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const i=c(r,8),n=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(n);for(let t=0;t<this.valueHex.byteLength;t++)s[t]=e[t];s[0]&=127;return c(s,8)-i}function h(e,t){const r=e.toString(10);if(t<r.length)return"";const i=t-r.length,n=new Array(i);for(let e=0;e<i;e++)n[e]="0";return n.join("").concat(r)}
/*!
   * Copyright (c) 2014, GMO GlobalSign
   * Copyright (c) 2015-2022, Peculiar Ventures
   * All rights reserved.
   * 
   * Author 2014-2019, Yury Strozhevsky
   * 
   * Redistribution and use in source and binary forms, with or without modification,
   * are permitted provided that the following conditions are met:
   * 
   * * Redistributions of source code must retain the above copyright notice, this
   *   list of conditions and the following disclaimer.
   * 
   * * Redistributions in binary form must reproduce the above copyright notice, this
   *   list of conditions and the following disclaimer in the documentation and/or
   *   other materials provided with the distribution.
   * 
   * * Neither the name of the copyright holder nor the names of its
   *   contributors may be used to endorse or promote products derived from
   *   this software without specific prior written permission.
   * 
   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
   * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
   * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
   * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
   * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
   * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   * 
   */function f(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function y(e){let t=0,r=0;for(let r=0;r<e.length;r++){t+=e[r].byteLength}const i=new Uint8Array(t);for(let t=0;t<e.length;t++){const n=e[t];i.set(new Uint8Array(n),r),r+=n.byteLength}return i.buffer}function d(e,t,r,i){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):i<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-i<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}o.DEFAULT_UTF8_ENCODING="utf8";class g{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return y(this.items)}}const v=[new Uint8Array([1])],m="0123456789",w="name",b="valueHexView",A="",S=new ArrayBuffer(0),B=new Uint8Array(0),k="EndOfContent",x="OCTET STRING",I="BIT STRING";function C(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?i.toUint8Array(r.valueHex):B}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){const i=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!d(this,i,t,r))return-1;const n=t+r;return this.valueHexView=i.subarray(t,n),this.valueHexView.length?(this.blockLength=r,n):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",S)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:o.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class E{constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:n=B}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=i.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:o.ToHex(this.valueBeforeDecodeView)}}}E.NAME="baseBlock";class N extends E{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}N.NAME="valueBlock";class O extends(C(E)){constructor({idBlock:e={}}={}){var t,r,n,s;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?i.toUint8Array(e.valueHex):B,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=e.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(s=e.isConstructed)&&void 0!==s&&s):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",S}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=u(this.tagNumber,7),i=new Uint8Array(r),n=r.byteLength,s=new Uint8Array(n+1);if(s[0]=31|t,!e){for(let e=0;e<n-1;e++)s[e+1]=128|i[e];s[n]=i[n-1]}return s.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const n=i.toUint8Array(e);if(!d(this,n,t,r))return-1;const s=n.subarray(t,t+r);if(0===s.length)return this.error="Zero buffer length",-1;switch(192&s[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&s[0]),this.isHexOnly=!1;const o=31&s[0];if(31!==o)this.tagNumber=o,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&s[e];){if(t[e-1]=127&s[e],e++,e>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&s[e];const i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(i),this.blockLength<=9?this.tagNumber=c(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}O.NAME="identificationBlock";class T extends E{constructor({lenBlock:e={}}={}){var t,r,i;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(i=e.length)&&void 0!==i?i:0}fromBER(e,t,r){const n=i.toUint8Array(e);if(!d(this,n,t,r))return-1;const s=n.subarray(t,t+r);if(0===s.length)return this.error="Zero buffer length",-1;if(255===s[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===s[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&s[0]),!1===this.longFormUsed)return this.length=s[0],this.blockLength=1,t+this.blockLength;const o=127&s[0];if(o>8)return this.error="Too big integer",-1;if(o+1>s.length)return this.error="End of input reached before message was fully decoded",-1;const a=t+1,u=n.subarray(a,a+o);return 0===u[o-1]&&this.warnings.push("Needlessly long encoded length"),this.length=c(u,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const i=u(this.length,8);if(i.byteLength>127)return this.error="Too big length",S;if(t=new ArrayBuffer(i.byteLength+1),e)return t;const n=new Uint8Array(i);r=new Uint8Array(t),r[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=n[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}T.NAME="lengthBlock";const U={};class j extends E{constructor({name:e="",optional:t=!1,primitiveSchema:r,...i}={},n){super(i),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new O(i),this.lenBlock=new T(i),this.valueBlock=n?new n(i):new N(i)}fromBER(e,t,r){const i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}toBER(e,t){const r=t||new g;t||R(this);const i=this.idBlock.toBER(e);if(r.write(i),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const i=this.lenBlock.toBER(e);r.write(i),r.write(t)}return t?S:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():o.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${o.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;return function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!1;return!0}(this.toBER(),e.toBER())}}function R(e){if(e instanceof U.Constructed)for(const t of e.valueBlock.value)R(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}j.NAME="BaseBlock";class P extends j{constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}P.NAME="BaseStringBlock";class V extends(C(N)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var H,L,D,M,$,_,F,z,K,q,G,J,W,Z,Y,X,Q,ee,te,re,ie,ne,se,oe,ae,ce,ue,le,pe,he,fe,ye,de;V.NAME="PrimitiveValueBlock";class ge extends j{constructor(e={}){super(e,V),this.idBlock.isConstructed=!1}}function ve(e,t=0,r=e.length){const i=t;let n=new j({},N);const s=new E;if(!d(s,e,t,r))return n.error=s.error,{offset:-1,result:n};if(!e.subarray(t,t+r).length)return n.error="Zero buffer length",{offset:-1,result:n};let o=n.idBlock.fromBER(e,t,r);if(n.idBlock.warnings.length&&n.warnings.concat(n.idBlock.warnings),-1===o)return n.error=n.idBlock.error,{offset:-1,result:n};if(t=o,r-=n.idBlock.blockLength,o=n.lenBlock.fromBER(e,t,r),n.lenBlock.warnings.length&&n.warnings.concat(n.lenBlock.warnings),-1===o)return n.error=n.lenBlock.error,{offset:-1,result:n};if(t=o,r-=n.lenBlock.blockLength,!n.idBlock.isConstructed&&n.lenBlock.isIndefiniteForm)return n.error="Indefinite length form used for primitive encoding form",{offset:-1,result:n};let a=j;if(1===n.idBlock.tagClass){if(n.idBlock.tagNumber>=37&&!1===n.idBlock.isHexOnly)return n.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:n};switch(n.idBlock.tagNumber){case 0:if(n.idBlock.isConstructed&&n.lenBlock.length>0)return n.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:n};a=U.EndOfContent;break;case 1:a=U.Boolean;break;case 2:a=U.Integer;break;case 3:a=U.BitString;break;case 4:a=U.OctetString;break;case 5:a=U.Null;break;case 6:a=U.ObjectIdentifier;break;case 10:a=U.Enumerated;break;case 12:a=U.Utf8String;break;case 13:a=U.RelativeObjectIdentifier;break;case 14:a=U.TIME;break;case 15:return n.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:n};case 16:a=U.Sequence;break;case 17:a=U.Set;break;case 18:a=U.NumericString;break;case 19:a=U.PrintableString;break;case 20:a=U.TeletexString;break;case 21:a=U.VideotexString;break;case 22:a=U.IA5String;break;case 23:a=U.UTCTime;break;case 24:a=U.GeneralizedTime;break;case 25:a=U.GraphicString;break;case 26:a=U.VisibleString;break;case 27:a=U.GeneralString;break;case 28:a=U.UniversalString;break;case 29:a=U.CharacterString;break;case 30:a=U.BmpString;break;case 31:a=U.DATE;break;case 32:a=U.TimeOfDay;break;case 33:a=U.DateTime;break;case 34:a=U.Duration;break;default:{const e=n.idBlock.isConstructed?new U.Constructed:new U.Primitive;e.idBlock=n.idBlock,e.lenBlock=n.lenBlock,e.warnings=n.warnings,n=e}}}else a=n.idBlock.isConstructed?U.Constructed:U.Primitive;return n=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(n,a),o=n.fromBER(e,t,n.lenBlock.isIndefiniteForm?r:n.lenBlock.length),n.valueBeforeDecodeView=e.subarray(i,i+n.blockLength),{offset:o,result:n}}function me(e){if(!e.byteLength){const e=new j({},N);return e.error="Input buffer has zero length",{offset:-1,result:e}}return ve(i.toUint8Array(e).slice(),0,e.byteLength)}H=ge,U.Primitive=H,ge.NAME="PRIMITIVE";class we extends N{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=i.toUint8Array(e);if(!d(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;o=this.isIndefiniteForm,a=r,(o?1:a)>0;){const e=ve(n,s,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(s=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===k)break}var o,a;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===k?this.value.pop():this.warnings.push("No EndOfContent block encoded")),s}toBER(e,t){const r=t||new g;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?S:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}we.NAME="ConstructedValueBlock";class be extends j{constructor(e={}){super(e,we),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const i=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===i?(this.error=this.valueBlock.error,i):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),i)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}L=be,U.Constructed=L,be.NAME="CONSTRUCTED";class Ae extends N{fromBER(e,t,r){return t}toBER(e){return S}}Ae.override="EndOfContentValueBlock";class Se extends j{constructor(e={}){super(e,Ae),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}D=Se,U.EndOfContent=D,Se.NAME=k;class Be extends j{constructor(e={}){super(e,N),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}M=Be,U.Null=M,Be.NAME="NULL";class ke extends(C(N)){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=i.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const n=i.toUint8Array(e);return d(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,p.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}ke.NAME="BooleanValueBlock";class xe extends j{constructor(e={}){super(e,ke),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}$=xe,U.Boolean=$,xe.NAME="BOOLEAN";class Ie extends(C(we)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let i=0;if(this.isConstructed){if(this.isHexOnly=!1,i=we.prototype.fromBER.call(this,e,t,r),-1===i)return i;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===k){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==x)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=super.fromBER(e,t,r),this.blockLength=r;return i}toBER(e,t){return this.isConstructed?we.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Ie.NAME="OctetStringValueBlock";class Ce extends j{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i,n;null!==(i=r.isConstructed)&&void 0!==i||(r.isConstructed=!!(null===(n=r.value)||void 0===n?void 0:n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Ie),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(i.byteLength){const e=ve(i,0,i.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?be.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${o.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Ce&&e.push(t.valueBlock.valueHexView);return i.concat(e)}}_=Ce,U.OctetString=_,Ce.NAME=x;class Ee extends(C(we)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=we.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(const e of this.value){const t=e.constructor.NAME;if(t===k){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==I)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const s=i.toUint8Array(e);if(!d(this,s,t,r))return-1;const o=s.subarray(t,t+r);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=o.subarray(1);try{if(e.byteLength){const t=ve(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,t+r}toBER(e,t){if(this.isConstructed)return we.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return S;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Ee.NAME="BitStringValueBlock";class Ne extends j{constructor({idBlock:e={},lenBlock:t={},...r}={}){var i,n;null!==(i=r.isConstructed)&&void 0!==i||(r.isConstructed=!!(null===(n=r.value)||void 0===n?void 0:n.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Ee),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return be.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function Oe(e,t){const r=new Uint8Array([0]),i=new Uint8Array(e),n=new Uint8Array(t);let s=i.slice(0);const o=s.length-1,a=n.slice(0),c=a.length-1;let u=0;let p=0;for(let e=c<o?o:c;e>=0;e--,p++){if(!0==p<a.length)u=s[o-p]+a[c-p]+r[0];else u=s[o-p]+r[0];if(r[0]=u/10,!0==p>=s.length)s=l(new Uint8Array([u%10]),s);else s[o-p]=u%10}return r[0]>0&&(s=l(r,s)),s}function Te(e){if(e>=v.length)for(let t=v.length;t<=e;t++){const e=new Uint8Array([0]);let r=v[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const i=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=i[0]/10,r[t]=i[0]%10}e[0]>0&&(r=l(e,r)),v.push(r)}return v[e]}function Ue(e,t){let r=0;const i=new Uint8Array(e),n=new Uint8Array(t),s=i.slice(0),o=s.length-1,a=n.slice(0),c=a.length-1;let u,l=0;for(let e=c;e>=0;e--,l++)if(u=s[o-l]-a[c-l]-r,!0==u<0)r=1,s[o-l]=u+10;else r=0,s[o-l]=u;if(r>0)for(let e=o-c+1;e>=0;e--,l++){if(u=s[o-l]-r,!(u<0)){r=0,s[o-l]=u;break}r=1,s[o-l]=u+10}return s.slice()}F=Ne,U.BitString=F,Ne.NAME=I;class je extends(C(N)){constructor({value:e,...t}={}){super(t),this._valueDec=0,void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=p.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let r=128;for(let i=1;i<8;i++){if(t<=r){if(e<0){const e=u(r-t,8,i);return new Uint8Array(e)[0]|=128,e}let n=u(t,8,i),s=new Uint8Array(n);if(128&s[0]){const e=n.slice(0),t=new Uint8Array(e);n=new ArrayBuffer(n.byteLength+1),s=new Uint8Array(n);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return n}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,i=0){const n=this.fromBER(e,t,r);if(-1===n)return n;const s=this.valueHexView;return 0===s[0]&&0!=(128&s[1])?this.valueHexView=s.subarray(1):0!==i&&s.length<i&&(i-s.length>1&&(i=s.length+1),this.valueHexView=s.subarray(i-s.length)),n}toDER(e=!1){const t=this.valueHexView;switch(!0){case 0!=(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0==(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const i=super.fromBER(e,t,r);return-1===i||this.setValueHex(),i}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),i=0;const n=this.valueHexView;let s="",o=!1;for(let o=n.byteLength-1;o>=0;o--){t=n[o];for(let n=0;n<8;n++){if(1==(1&t))if(i===e)r=Ue(Te(i),r),s="-";else r=Oe(r,Te(i));i++,t>>=1}}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(s+=m.charAt(r[e]));return!1===o&&(s+=m.charAt(0)),s}}z=je,je.NAME="IntegerValueBlock",Object.defineProperty(z.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Re extends j{constructor(e={}){super(e,je),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return f(),BigInt(this.valueBlock.toString())}static fromBigInt(e){f();const t=BigInt(e),r=new g,n=t.toString(16).replace(/^-/,""),s=new Uint8Array(o.FromHex(n));if(t<0){const e=new Uint8Array(s.length+(128&s[0]?1:0));e[0]|=128;const n=BigInt(`0x${o.ToHex(e)}`)+t,a=i.toUint8Array(o.FromHex(n.toString(16)));a[0]|=128,r.write(a)}else 128&s[0]&&r.write(new Uint8Array([0])),r.write(s);return new Re({valueHex:r.final()})}convertToDER(){const e=new Re({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new Re({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}K=Re,U.Integer=K,Re.NAME="INTEGER";class Pe extends Re{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}q=Pe,U.Enumerated=q,Pe.NAME="ENUMERATED";class Ve extends(C(N)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=i.toUint8Array(e);if(!d(this,n,t,r))return-1;const s=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&s[e],this.blockLength++,0!=(128&s[e]));e++);const o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return this.valueHexView=o,0!=(128&s[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=c(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){f();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=u(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",S;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r}toString(){let e="";if(this.isHexOnly)e=o.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Ve.NAME="sidBlock";class He extends N{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){const t=new Ve;if(i=t.fromBER(e,i,r),-1===i)return this.blockLength=0,this.error=t.error,i;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,S;t.push(i)}return y(t)}fromString(e){this.value=[];let t=0,r=0,i="",n=!1;do{if(r=e.indexOf(".",t),i=-1===r?e.substring(t):e.substring(t,r),t=r+1,n){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(i,10);if(isNaN(r))return;e.valueDec=r+t,n=!1}else{const e=new Ve;if(i>Number.MAX_SAFE_INTEGER){f();const t=BigInt(i);e.valueBigInt=t}else if(e.valueDec=parseInt(i,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,n=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,this.value[r].isFirstSid?e=`2.{${i} - 80}`:e+=i):e+=i}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}He.NAME="ObjectIdentifierValueBlock";class Le extends j{constructor(e={}){super(e,He),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}G=Le,U.ObjectIdentifier=G,Le.NAME="OBJECT IDENTIFIER";class De extends(C(E)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const n=i.toUint8Array(e);if(!d(this,n,t,r))return-1;const s=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&s[e],this.blockLength++,0!=(128&s[e]));e++);const o=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)o[e]=this.valueHexView[e];return this.valueHexView=o,0!=(128&s[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=c(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=u(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",S;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),i=t.byteLength-1;for(let t=0;t<i;t++)r[t]=128|e[t];r[i]=e[i]}return r.buffer}toString(){let e="";return e=this.isHexOnly?o.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}De.NAME="relativeSidBlock";class Me extends N{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let i=t;for(;r>0;){const t=new De;if(i=t.fromBER(e,i,r),-1===i)return this.blockLength=0,this.error=t.error,i;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return i}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const i=this.value[t].toBER(e);if(0===i.byteLength)return this.error=this.value[t].error,S;r.push(i)}return y(r)}fromString(e){this.value=[];let t=0,r=0,i="";do{r=e.indexOf(".",t),i=-1===r?e.substring(t):e.substring(t,r),t=r+1;const n=new De;if(n.valueDec=parseInt(i,10),isNaN(n.valueDec))return!0;this.value.push(n)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let i=this.value[r].toString();0!==r&&(e=`${e}.`),t?(i=`{${i}}`,e+=i):e+=i}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}Me.NAME="RelativeObjectIdentifierValueBlock";class $e extends j{constructor(e={}){super(e,Me),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}J=$e,U.RelativeObjectIdentifier=J,$e.NAME="RelativeObjectIdentifier";class _e extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}W=_e,U.Sequence=W,_e.NAME="SEQUENCE";class Fe extends be{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}Z=Fe,U.Set=Z,Fe.NAME="SET";class ze extends(C(N)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=A}toJSON(){return{...super.toJSON(),value:this.value}}}ze.NAME="StringValueBlock";class Ke extends ze{}Ke.NAME="SimpleStringValueBlock";class qe extends P{constructor({...e}={}){super(e,Ke)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,i.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.charCodeAt(i);this.valueBlock.value=e}}qe.NAME="SIMPLE STRING";class Ge extends qe{fromBuffer(e){this.valueBlock.valueHexView=i.toUint8Array(e);try{this.valueBlock.value=o.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=o.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(o.FromUtf8String(e)),this.valueBlock.value=e}}Ge.NAME="Utf8StringValueBlock";class Je extends Ge{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Y=Je,U.Utf8String=Y,Je.NAME="UTF8String";class We extends qe{fromBuffer(e){this.valueBlock.value=o.ToUtf16String(e),this.valueBlock.valueHexView=i.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(o.FromUtf16String(e))}}We.NAME="BmpStringValueBlock";class Ze extends We{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}X=Ze,U.BmpString=X,Ze.NAME="BMPString";class Ye extends qe{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let i=0;i<t;i++){const t=u(e.charCodeAt(i),8),n=new Uint8Array(t);if(n.length>4)continue;const s=4-n.length;for(let e=n.length-1;e>=0;e--)r[4*i+e+s]=n[e]}this.valueBlock.value=e}}Ye.NAME="UniversalStringValueBlock";class Xe extends Ye{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Q=Xe,U.UniversalString=Q,Xe.NAME="UniversalString";class Qe extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}ee=Qe,U.NumericString=ee,Qe.NAME="NumericString";class et extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}te=et,U.PrintableString=te,et.NAME="PrintableString";class tt extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}re=tt,U.TeletexString=re,tt.NAME="TeletexString";class rt extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}ie=rt,U.VideotexString=ie,rt.NAME="VideotexString";class it extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}ne=it,U.IA5String=ne,it.NAME="IA5String";class nt extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}se=nt,U.GraphicString=se,nt.NAME="GraphicString";class st extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}oe=st,U.VisibleString=oe,st.NAME="VisibleString";class ot extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}ae=ot,U.GeneralString=ae,ot.NAME="GeneralString";class at extends qe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}ce=at,U.CharacterString=ce,at.NAME="CharacterString";class ct extends st{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,i.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=h(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=h(this.month,2),e[2]=h(this.day,2),e[3]=h(this.hour,2),e[4]=h(this.minute,2),e[5]=h(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}ue=ct,U.UTCTime=ue,ct.NAME="UTCTime";class ut extends ct{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,i="",n="",s=0,o=0,a=0;if("Z"===e[e.length-1])i=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");i=e}if(r){if(-1!==i.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==i.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=i.indexOf("+"),r="";if(-1===t&&(t=i.indexOf("-"),e=-1),-1!==t){if(r=i.substring(t+1),i=i.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let n=parseInt(r.substring(0,2),10);if(isNaN(n.valueOf()))throw new Error("Wrong input string for conversion");if(o=e*n,4===r.length){if(n=parseInt(r.substring(2,4),10),isNaN(n.valueOf()))throw new Error("Wrong input string for conversion");a=e*n}}}let c=i.indexOf(".");if(-1===c&&(c=i.indexOf(",")),-1!==c){const e=new Number(`0${i.substring(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=e.valueOf(),n=i.substring(0,c)}else n=i;switch(!0){case 8===n.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===n.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const u=t.exec(n);if(null===u)throw new Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+o;break;case 5:this.minute=parseInt(u[e],10)+a;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(h(this.year,4)),e.push(h(this.month,2)),e.push(h(this.day,2)),e.push(h(this.hour,2)),e.push(h(this.minute,2)),e.push(h(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(h(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}le=ut,U.GeneralizedTime=le,ut.NAME="GeneralizedTime";class lt extends Je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}pe=lt,U.DATE=pe,lt.NAME="DATE";class pt extends Je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}he=pt,U.TimeOfDay=he,pt.NAME="TimeOfDay";class ht extends Je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}fe=ht,U.DateTime=fe,ht.NAME="DateTime";class ft extends Je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}ye=ft,U.Duration=ye,ft.NAME="Duration";class yt extends Je{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}de=yt,U.TIME=de,yt.NAME="TIME";class dt{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class gt extends dt{constructor({value:e=[],...t}={}){super(t),this.value=e}}class vt extends dt{constructor({value:e=new dt,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}function mt(e,t,r){if(r instanceof gt){for(let i=0;i<r.value.length;i++){if(mt(e,t,r.value[i]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(w)&&(e.name=r.name),e}}if(r instanceof dt)return r.hasOwnProperty(w)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=r.idBlock.toBER(!1);if(0===i.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(i,0,i.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(b in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const i=r.idBlock.valueHexView,n=t.idBlock.valueHexView;if(i.length!==n.length)return{verified:!1,result:e};for(let t=0;t<i.length;t++)if(i[t]!==n[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&(e[r.name]=t)),r instanceof U.Constructed){let i=0,n={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof vt&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<s;o++)if(o-i>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof vt){if(n=mt(e,t.valueBlock.value[o],r.valueBlock.value[0].value),!1===n.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&delete e[r.name]),n;i++}if(w in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let i={};i="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===i[r.valueBlock.value[0].name]&&(i[r.valueBlock.value[0].name]=[]),i[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(n=mt(e,t.valueBlock.value[o-i],r.valueBlock.value[o]),!1===n.verified){if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&delete e[r.name]),n;i++}if(!1===n.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&b in t.valueBlock){const i=ve(t.valueBlock.valueHexView);if(-1===i.offset){const t={verified:!1,result:i.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,A),r.name&&(delete e[r.name],t.name=r.name)),t}return mt(e,i.result,r.primitiveSchema)}return{verified:!0,result:e}}var wt,bt,At=Object.freeze({__proto__:null,Any:dt,BaseBlock:j,BaseStringBlock:P,BitString:Ne,BmpString:Ze,Boolean:xe,CharacterString:at,Choice:gt,Constructed:be,DATE:lt,DateTime:ht,Duration:ft,EndOfContent:Se,Enumerated:Pe,GeneralString:ot,GeneralizedTime:ut,GraphicString:nt,HexBlock:C,IA5String:it,Integer:Re,Null:Be,NumericString:Qe,ObjectIdentifier:Le,OctetString:Ce,Primitive:ge,PrintableString:et,RawData:class{constructor({data:e=B}={}){this.dataView=i.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=i.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=i.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}},RelativeObjectIdentifier:$e,Repeated:vt,Sequence:_e,Set:Fe,TIME:yt,TeletexString:tt,TimeOfDay:pt,UTCTime:ct,UniversalString:Xe,Utf8String:Je,ValueBlock:N,VideotexString:rt,ViewWriter:g,VisibleString:st,compareSchema:mt,fromBER:me,verifySchema:function(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=ve(i.toUint8Array(e));return-1===r.offset?{verified:!1,result:r.result}:mt(r.result,r.result,t)}});!function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"}(wt||(wt={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(bt||(bt={}));const St={fromASN:e=>e instanceof Be?null:e.valueBeforeDecode,toASN:e=>{if(null===e)return new Be;const t=me(e);if(t.result.error)throw new Error(t.result.error);return t.result}},Bt={fromASN:e=>e.valueBlock.valueHex.byteLength>4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new Re({value:e})},kt={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new Pe({value:e})},xt={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new Re({valueHex:e})},It={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new Ne({valueHex:e})},Ct={fromASN:e=>e.valueBlock.toString(),toASN:e=>new Le({value:e})},Et={fromASN:e=>e.valueBlock.value,toASN:e=>new xe({value:e})},Nt={fromASN:e=>e.valueBlock.valueHex,toASN:e=>new Ce({valueHex:e})};function Ot(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const Tt=Ot(Je),Ut=Ot(Ze),jt=Ot(Xe),Rt=Ot(Qe),Pt=Ot(et),Vt=Ot(tt),Ht=Ot(rt),Lt=Ot(it),Dt=Ot(nt),Mt=Ot(st),$t=Ot(ot),_t=Ot(at),Ft={fromASN:e=>e.toDate(),toASN:e=>new ct({valueDate:e})},zt={fromASN:e=>e.toDate(),toASN:e=>new ut({valueDate:e})},Kt={fromASN:e=>null,toASN:e=>new Be};function qt(e){switch(e){case bt.Any:return St;case bt.BitString:return It;case bt.BmpString:return Ut;case bt.Boolean:return Et;case bt.CharacterString:return _t;case bt.Enumerated:return kt;case bt.GeneralString:return $t;case bt.GeneralizedTime:return zt;case bt.GraphicString:return Dt;case bt.IA5String:return Lt;case bt.Integer:return Bt;case bt.Null:return Kt;case bt.NumericString:return Rt;case bt.ObjectIdentifier:return Ct;case bt.OctetString:return Nt;case bt.PrintableString:return Pt;case bt.TeletexString:return Vt;case bt.UTCTime:return Ft;case bt.UniversalString:return jt;case bt.Utf8String:return Tt;case bt.VideotexString:return Ht;case bt.VisibleString:return Mt;default:return null}}class Gt{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!i.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=i.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof Ne))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new Ne({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new Ne({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const i=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let n=0;for(;n<r;)i[n]=parseInt(t.slice(n<<3,8+(n<<3)),2),n++;this.value=i.buffer}}class Jt{constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):i.isBufferSource(e)?this.buffer=i.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}fromASN(e){if(!(e instanceof Ce))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new Ce({valueHex:this.buffer})}toSchema(e){return new Ce({name:e})}}function Wt(e){return e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||Wt(e.prototype):!!(e&&e.toASN&&e.fromASN)}function Zt(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||Zt(r)}return!1}function Yt(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),i=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==i[t])return!1;return!0}const Xt=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e){var t,r,i;const n=this.items.get(e);if(!n)throw new Error(`Cannot get schema for '${null!==(i=null===(r=null===(t=null==e?void 0:e.prototype)||void 0===t?void 0:t.constructor)||void 0===r?void 0:r.name)&&void 0!==i?i:e}' target`);return n}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:wt.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(e,t){const r=this.items.get(e)||this.createDefault(e),i=[];for(const e in r.items){const n=r.items[e],s=t?e:"";let o;if("number"==typeof n.type){const e=bt[n.type],t=At[e];if(!t)throw new Error(`Cannot get ASN1 class by name '${e}'`);o=new t({name:s})}else if(Wt(n.type)){o=(new n.type).toSchema(s)}else if(n.optional){this.get(n.type).type===wt.Choice?o=new dt({name:s}):(o=this.create(n.type,!1),o.name=s)}else o=new dt({name:s});const a=!!n.optional||void 0!==n.defaultValue;if(n.repeated){o.name="";o=new("set"===n.repeated?Fe:_e)({name:"",value:[new vt({name:s,value:o})]})}if(null!==n.context&&void 0!==n.context)if(n.implicit)if("number"==typeof n.type||Wt(n.type)){const e=n.repeated?be:ge;i.push(new e({name:s,optional:a,idBlock:{tagClass:3,tagNumber:n.context}}))}else{this.cache(n.type);const e=!!n.repeated;let t=e?o:this.get(n.type).schema;t=t.valueBlock?t.valueBlock.value:t.value,i.push(new be({name:e?"":s,optional:a,idBlock:{tagClass:3,tagNumber:n.context},value:t}))}else i.push(new be({optional:a,idBlock:{tagClass:3,tagNumber:n.context},value:[o]}));else o.optional=a,i.push(o)}switch(r.type){case wt.Sequence:return new _e({value:i,name:""});case wt.Set:return new Fe({value:i,name:""});case wt.Choice:return new gt({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=e.__proto__;if(t){return this.items.get(t)||this.findParentSchema(t)}return null}},Qt=e=>t=>{let r;Xt.has(t)?r=Xt.get(t):(r=Xt.createDefault(t),Xt.set(t,r)),Object.assign(r,e)},er=e=>(t,r)=>{let i;Xt.has(t.constructor)?i=Xt.get(t.constructor):(i=Xt.createDefault(t.constructor),Xt.set(t.constructor,i));const n=Object.assign({},e);if("number"==typeof n.type&&!n.converter){const i=qt(e.type);if(!i)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);n.converter=i}i.items[r]=n};class tr extends Error{constructor(){super(...arguments),this.schemas=[]}}class rr{static serialize(e){return e instanceof j?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&Wt(e.constructor))return e.toASN();const t=e.constructor,r=Xt.get(t);Xt.cache(t);let i,n=[];if(r.itemType)if("number"==typeof r.itemType){const i=qt(r.itemType);if(!i)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);n=e.map((e=>i.toASN(e)))}else n=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)));else for(const i in r.items){const s=r.items[i],o=e[i];if(void 0===o||s.defaultValue===o||"object"==typeof s.defaultValue&&"object"==typeof o&&Yt(this.serialize(s.defaultValue),this.serialize(o)))continue;let a=rr.toAsnItem(s,i,t,o);if("number"==typeof s.context)if(s.implicit)if(s.repeated||"number"!=typeof s.type&&!Wt(s.type))n.push(new be({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a instanceof Be?a.valueBeforeDecode:a.valueBlock.toBER(),n.push(new ge({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},...e}))}else n.push(new be({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else s.repeated?n=n.concat(a):n.push(a)}switch(r.type){case wt.Sequence:i=new _e({value:n});break;case wt.Set:i=new Fe({value:n});break;case wt.Choice:if(!n[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);i=n[0]}return i}static toAsnItem(e,t,r,i){let n;if("number"==typeof e.type){const s=e.converter;if(!s)throw new Error(`Property '${t}' doesn't have converter for type ${bt[e.type]} in schema '${r.name}'`);if(e.repeated){const t=Array.from(i,(e=>s.toASN(e)));n=new("sequence"===e.repeated?_e:Fe)({value:t})}else n=s.toASN(i)}else if(e.repeated){const t=Array.from(i,(e=>this.toASN(e)));n=new("sequence"===e.repeated?_e:Fe)({value:t})}else n=this.toASN(i);return n}}class ir extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class nr{static serialize(e){return rr.serialize(e)}static parse(e,t){return class{static parse(e,t){let r;if(e instanceof ArrayBuffer)r=e;else if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))r=new Uint8Array(e).buffer;else{if(!(ArrayBuffer.isView(e)||e.buffer instanceof ArrayBuffer))throw new TypeError("Wrong type of 'data' argument");r=e.buffer}const i=me(r);if(i.result.error)throw new Error(i.result.error);return this.fromASN(i.result,t)}static fromASN(e,t){var r;try{if(Wt(t))return(new t).fromASN(e);const i=Xt.get(t);Xt.cache(t);let n=i.schema;if(e.constructor===be&&i.type!==wt.Choice){n=new be({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:i.schema.valueBlock.value});for(const t in i.items)delete e[t]}const s=mt(e,e,n);if(!s.verified)throw new tr(`Data does not match to ${t.name} ASN1 schema. ${s.result.error}`);const o=new t;if(Zt(t)){if("number"==typeof i.itemType){const r=qt(i.itemType);if(!r)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);return t.from(e.valueBlock.value,(e=>r.fromASN(e)))}return t.from(e.valueBlock.value,(e=>this.fromASN(e,i.itemType)))}for(const t in i.items){if(!e[t])continue;const n=i.items[t];if("number"==typeof n.type||Wt(n.type)){const i=null!==(r=n.converter)&&void 0!==r?r:Wt(n.type)?new n.type:null;if(!i)throw new Error("Converter is empty");if(n.repeated)if(n.implicit){const r=new("sequence"===n.repeated?_e:Fe);r.valueBlock=e[t].valueBlock;const s=me(r.toBER(!1)).result.valueBlock.value;o[t]=Array.from(s,(e=>i.fromASN(e)))}else o[t]=Array.from(e[t],(e=>i.fromASN(e)));else{let r=e[t];if(n.implicit){let e;if(Wt(n.type))e=(new n.type).toSchema("");else{const t=bt[n.type],r=At[t];if(!r)throw new Error(`Cannot get '${t}' class from asn1js module`);e=new r}e.valueBlock=r.valueBlock,r=me(e.toBER(!1)).result}o[t]=i.fromASN(r)}}else n.repeated?o[t]=Array.from(e[t],(e=>this.fromASN(e,n.type))):o[t]=this.fromASN(e[t],n.type)}return o}catch(e){throw e instanceof tr&&e.schemas.push(t.name),e}}}.parse(e,t)}static toString(e){const t=me(i.isBufferSource(e)?i.toArrayBuffer(e):nr.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}function sr(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}var or,ar,cr,ur,lr={exports:{}};or=lr,function(e){const t="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${t}\\.${t}\\.${t}\\.${t}$`,"i"),threeOctet:new RegExp(`^${t}\\.${t}\\.${t}$`,"i"),twoOctet:new RegExp(`^${t}\\.${t}$`,"i"),longValue:new RegExp(`^${t}$`,"i")},i=new RegExp("^0[0-7]+$","i"),n=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${t}\\.${t}\\.${t}\\.${t}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${t}\\.${t}\\.${t}\\.${t}(${s})?$`,"i")};function c(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,i,n=0,s=-1,o=(e.match(a.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(s=e.indexOf(":",s+1))>=0;)n++;if("::"===e.substr(0,2)&&n--,"::"===e.substr(-2,2)&&n--,n>t)return null;for(i=t-n,r=":";i--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),{parts:t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),zoneId:o}}function u(e,t,r,i){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let n,s=0;for(;i>0;){if(n=r-i,n<0&&(n=0),e[s]>>n!=t[s]>>n)return!1;i-=r,s+=1}return!0}function l(e){if(n.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function p(e,t){for(;e.length<t;)e=`0${e}`;return e}const h={};h.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let i,n,s;for(i=3;i>=0;i-=1){if(n=this.octets[i],!(n in r))return null;if(s=r[n],t&&0!==s)return null;8!==s&&(t=!0),e+=s}return 32-e},e.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return h.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),h.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[];let s=0;for(;s<4;)n.push(parseInt(r[s],10)|255^parseInt(i[s],10)),s++;return new this(n)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.isIPv4=function(e){return null!==this.parser(e)},h.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},h.IPv4.isValidFourPartDecimal=function(e){return!(!h.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},h.IPv4.networkAddressFromCIDR=function(e){let t,r,i,n,s;try{for(t=this.parseCIDR(e),i=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<4;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},h.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},h.IPv4.parser=function(e){let t,i,n;if(t=e.match(r.fourOctet))return function(){const e=t.slice(1,6),r=[];for(let t=0;t<e.length;t++)i=e[t],r.push(l(i));return r}();if(t=e.match(r.longValue)){if(n=l(t[1]),n>4294967295||n<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(n>>t&255);return e}().reverse()}return(t=e.match(r.twoOctet))?function(){const e=t.slice(1,4),r=[];if(n=l(e[1]),n>16777215||n<0)throw new Error("ipaddr: address outside defined range");return r.push(l(e[0])),r.push(n>>16&255),r.push(n>>8&255),r.push(255&n),r}():(t=e.match(r.threeOctet))?function(){const e=t.slice(1,5),r=[];if(n=l(e[2]),n>65535||n<0)throw new Error("ipaddr: address outside defined range");return r.push(l(e[0])),r.push(l(e[1])),r.push(n>>8&255),r.push(255&n),r}():null},h.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const i=Math.floor(e/8);for(;r<i;)t[r]=255,r++;return i<4&&(t[i]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},h.IPv6=function(){function e(e,t){let r,i;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(i=this.parts[r],!(0<=i&&i<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let i,n;for(let s=7;s>=0;s-=1){if(i=this.parts[s],!(i in r))return null;if(n=r[i],t&&0!==n)return null;16!==n&&(t=!0),e+=n}return 128-e},e.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let i=0;i<r.length;i++)e=r[i],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(p(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new h.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,i=0,n=-1;for(;r=e.exec(t);)r[0].length>n&&(i=r.index,n=r[0].length);return n<0?t:`${t.substring(0,i)}::${t.substring(i+n)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),h.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),i=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[];let s=0;for(;s<16;)n.push(parseInt(r[s],10)|255^parseInt(i[s],10)),s++;return new this(n)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},h.IPv6.isIPv6=function(e){return null!==this.parser(e)},h.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},h.IPv6.networkAddressFromCIDR=function(e){let t,r,i,n,s;try{for(t=this.parseCIDR(e),i=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),n=[],r=0;r<16;)n.push(parseInt(i[r],10)&parseInt(s[r],10)),r++;return new this(n)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},h.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},h.IPv6.parseCIDR=function(e){let t,r,i;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return i=[this.parse(r[1]),t],Object.defineProperty(i,"toString",{value:function(){return this.join("/")}}),i;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},h.IPv6.parser=function(e){let t,r,i,n,s,o;if(i=e.match(a.deprecatedTransitional))return this.parser(`::ffff:${i[1]}`);if(a.native.test(e))return c(e,8);if((i=e.match(a.transitional))&&(o=i[6]||"",t=c(i[1].slice(0,-1)+o,6),t.parts)){for(s=[parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseInt(i[5])],r=0;r<s.length;r++)if(n=s[r],!(0<=n&&n<=255))return null;return t.parts.push(s[0]<<8|s[1]),t.parts.push(s[2]<<8|s[3]),{parts:t.parts,zoneId:t.zoneId}}return null},h.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const i=Math.floor(e/8);for(;r<i;)t[r]=255,r++;return i<16&&(t[i]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},h.fromByteArray=function(e){const t=e.length;if(4===t)return new h.IPv4(e);if(16===t)return new h.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},h.isValid=function(e){return h.IPv6.isValid(e)||h.IPv4.isValid(e)},h.parse=function(e){if(h.IPv6.isValid(e))return h.IPv6.parse(e);if(h.IPv4.isValid(e))return h.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},h.parseCIDR=function(e){try{return h.IPv6.parseCIDR(e)}catch(t){try{return h.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},h.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},h.subnetMatch=function(e,t,r){let i,n,s,o;for(n in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,n))for(s=t[n],!s[0]||s[0]instanceof Array||(s=[s]),i=0;i<s.length;i++)if(o=s[i],e.kind()===o[0].kind()&&e.match.apply(e,o))return n;return r},or.exports?or.exports=h:e.ipaddr=h}(r);class pr{static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){if(4===e.byteLength||16===e.byteLength){const t=new Uint8Array(e);return lr.exports.fromByteArray(Array.from(t)).toString()}return this.decodeIP(o.ToHex(e))}static fromString(e){const t=lr.exports.parse(e);return new Uint8Array(t.toByteArray()).buffer}}let hr=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};sr([er({type:bt.TeletexString})],hr.prototype,"teletexString",void 0),sr([er({type:bt.PrintableString})],hr.prototype,"printableString",void 0),sr([er({type:bt.UniversalString})],hr.prototype,"universalString",void 0),sr([er({type:bt.Utf8String})],hr.prototype,"utf8String",void 0),sr([er({type:bt.BmpString})],hr.prototype,"bmpString",void 0),hr=sr([Qt({type:wt.Choice})],hr);let fr=class extends hr{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?o.ToHex(this.anyValue):super.toString())}};sr([er({type:bt.IA5String})],fr.prototype,"ia5String",void 0),sr([er({type:bt.Any})],fr.prototype,"anyValue",void 0),fr=sr([Qt({type:wt.Choice})],fr);class yr{constructor(e={}){this.type="",this.value=new fr,Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],yr.prototype,"type",void 0),sr([er({type:fr})],yr.prototype,"value",void 0);let dr=ar=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,ar.prototype)}};dr=ar=sr([Qt({type:wt.Set,itemType:yr})],dr);let gr=cr=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,cr.prototype)}};gr=cr=sr([Qt({type:wt.Sequence,itemType:dr})],gr);let vr=ur=class extends gr{constructor(e){super(e),Object.setPrototypeOf(this,ur.prototype)}};vr=ur=sr([Qt({type:wt.Sequence})],vr);const mr={fromASN:e=>pr.toString(Nt.fromASN(e)),toASN:e=>Nt.toASN(pr.fromString(e))};class wr{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],wr.prototype,"typeId",void 0),sr([er({type:bt.Any,context:0})],wr.prototype,"value",void 0);class br{constructor(e={}){this.partyName=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:hr,optional:!0,context:0,implicit:!0})],br.prototype,"nameAssigner",void 0),sr([er({type:hr,context:1,implicit:!0})],br.prototype,"partyName",void 0);let Ar=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:wr,context:0,implicit:!0})],Ar.prototype,"otherName",void 0),sr([er({type:bt.IA5String,context:1,implicit:!0})],Ar.prototype,"rfc822Name",void 0),sr([er({type:bt.IA5String,context:2,implicit:!0})],Ar.prototype,"dNSName",void 0),sr([er({type:bt.Any,context:3,implicit:!0})],Ar.prototype,"x400Address",void 0),sr([er({type:vr,context:4,implicit:!1})],Ar.prototype,"directoryName",void 0),sr([er({type:br,context:5})],Ar.prototype,"ediPartyName",void 0),sr([er({type:bt.IA5String,context:6,implicit:!0})],Ar.prototype,"uniformResourceIdentifier",void 0),sr([er({type:bt.OctetString,context:7,implicit:!0,converter:mr})],Ar.prototype,"iPAddress",void 0),sr([er({type:bt.ObjectIdentifier,context:8,implicit:!0})],Ar.prototype,"registeredID",void 0),Ar=sr([Qt({type:wt.Choice})],Ar);var Sr;class Br{constructor(e={}){this.accessMethod="",this.accessLocation=new Ar,Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Br.prototype,"accessMethod",void 0),sr([er({type:Ar})],Br.prototype,"accessLocation",void 0);let kr=Sr=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Sr.prototype)}};kr=Sr=sr([Qt({type:wt.Sequence,itemType:Br})],kr);const xr="2.5.29.35";class Ir extends Jt{}class Cr{constructor(e={}){e&&Object.assign(this,e)}}sr([er({type:Ir,context:0,optional:!0,implicit:!0})],Cr.prototype,"keyIdentifier",void 0),sr([er({type:Ar,context:1,optional:!0,implicit:!0,repeated:"sequence"})],Cr.prototype,"authorityCertIssuer",void 0),sr([er({type:bt.Integer,context:2,optional:!0,implicit:!0,converter:xt})],Cr.prototype,"authorityCertSerialNumber",void 0);const Er="2.5.29.19";class Nr{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Or;sr([er({type:bt.Boolean,defaultValue:!1})],Nr.prototype,"cA",void 0),sr([er({type:bt.Integer,optional:!0})],Nr.prototype,"pathLenConstraint",void 0);let Tr=Or=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Or.prototype)}};var Ur;Tr=Or=sr([Qt({type:wt.Sequence,itemType:Ar})],Tr);let jr=Ur=class extends Tr{constructor(e){super(e),Object.setPrototypeOf(this,Ur.prototype)}};var Rr;jr=Ur=sr([Qt({type:wt.Sequence})],jr);const Pr="2.5.29.32";let Vr=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String}};sr([er({type:bt.IA5String})],Vr.prototype,"ia5String",void 0),sr([er({type:bt.VisibleString})],Vr.prototype,"visibleString",void 0),sr([er({type:bt.BmpString})],Vr.prototype,"bmpString",void 0),sr([er({type:bt.Utf8String})],Vr.prototype,"utf8String",void 0),Vr=sr([Qt({type:wt.Choice})],Vr);class Hr{constructor(e={}){this.organization=new Vr,this.noticeNumbers=[],Object.assign(this,e)}}sr([er({type:Vr})],Hr.prototype,"organization",void 0),sr([er({type:bt.Integer,repeated:"sequence"})],Hr.prototype,"noticeNumbers",void 0);class Lr{constructor(e={}){Object.assign(this,e)}}sr([er({type:Hr,optional:!0})],Lr.prototype,"noticeRef",void 0),sr([er({type:Vr,optional:!0})],Lr.prototype,"explicitText",void 0);let Dr=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:bt.IA5String})],Dr.prototype,"cPSuri",void 0),sr([er({type:Lr})],Dr.prototype,"userNotice",void 0),Dr=sr([Qt({type:wt.Choice})],Dr);class Mr{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Mr.prototype,"policyQualifierId",void 0),sr([er({type:bt.Any})],Mr.prototype,"qualifier",void 0);class $r{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],$r.prototype,"policyIdentifier",void 0),sr([er({type:Mr,repeated:"sequence",optional:!0})],$r.prototype,"policyQualifiers",void 0);let _r=Rr=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Rr.prototype)}};_r=Rr=sr([Qt({type:wt.Sequence,itemType:$r})],_r);let Fr=class{constructor(e=0){this.value=e}};sr([er({type:bt.Integer})],Fr.prototype,"value",void 0),Fr=sr([Qt({type:wt.Choice})],Fr);let zr=class extends Fr{};var Kr,qr;zr=sr([Qt({type:wt.Choice})],zr),function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(qr||(qr={}));class Gr extends Gt{toJSON(){const e=[],t=this.toNumber();return t&qr.aACompromise&&e.push("aACompromise"),t&qr.affiliationChanged&&e.push("affiliationChanged"),t&qr.cACompromise&&e.push("cACompromise"),t&qr.certificateHold&&e.push("certificateHold"),t&qr.cessationOfOperation&&e.push("cessationOfOperation"),t&qr.keyCompromise&&e.push("keyCompromise"),t&qr.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&qr.superseded&&e.push("superseded"),t&qr.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let Jr=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:Ar,context:0,repeated:"sequence",implicit:!0})],Jr.prototype,"fullName",void 0),sr([er({type:dr,context:1,implicit:!0})],Jr.prototype,"nameRelativeToCRLIssuer",void 0),Jr=sr([Qt({type:wt.Choice})],Jr);class Wr{constructor(e={}){Object.assign(this,e)}}sr([er({type:Jr,context:0,optional:!0})],Wr.prototype,"distributionPoint",void 0),sr([er({type:Gr,context:1,optional:!0,implicit:!0})],Wr.prototype,"reasons",void 0),sr([er({type:Ar,context:2,optional:!0,repeated:"sequence",implicit:!0})],Wr.prototype,"cRLIssuer",void 0);let Zr=Kr=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Kr.prototype)}};var Yr;Zr=Kr=sr([Qt({type:wt.Sequence,itemType:Wr})],Zr);let Xr=Yr=class extends Zr{constructor(e){super(e),Object.setPrototypeOf(this,Yr.prototype)}};Xr=Yr=sr([Qt({type:wt.Sequence,itemType:Wr})],Xr);class Qr{constructor(e={}){this.onlyContainsUserCerts=Qr.ONLY,this.onlyContainsCACerts=Qr.ONLY,this.indirectCRL=Qr.ONLY,this.onlyContainsAttributeCerts=Qr.ONLY,Object.assign(this,e)}}var ei;Qr.ONLY=!1,sr([er({type:Jr,context:0,optional:!0})],Qr.prototype,"distributionPoint",void 0),sr([er({type:bt.Boolean,context:1,defaultValue:Qr.ONLY})],Qr.prototype,"onlyContainsUserCerts",void 0),sr([er({type:bt.Boolean,context:2,defaultValue:Qr.ONLY})],Qr.prototype,"onlyContainsCACerts",void 0),sr([er({type:Gr,context:3,optional:!0})],Qr.prototype,"onlySomeReasons",void 0),sr([er({type:bt.Boolean,context:4,defaultValue:Qr.ONLY})],Qr.prototype,"indirectCRL",void 0),sr([er({type:bt.Boolean,context:5,defaultValue:Qr.ONLY})],Qr.prototype,"onlyContainsAttributeCerts",void 0),function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(ei||(ei={}));let ti=class{constructor(e=ei.unspecified){this.reason=ei.unspecified,this.reason=e}toJSON(){return ei[this.reason]}toString(){return this.toJSON()}};var ri;sr([er({type:bt.Enumerated})],ti.prototype,"reason",void 0),ti=sr([Qt({type:wt.Choice})],ti);const ii="2.5.29.37";let ni=ri=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,ri.prototype)}};ni=ri=sr([Qt({type:wt.Sequence,itemType:bt.ObjectIdentifier})],ni);let si=class{constructor(e=new ArrayBuffer(0)){this.value=e}};sr([er({type:bt.Integer,converter:xt})],si.prototype,"value",void 0),si=sr([Qt({type:wt.Choice})],si);let oi=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var ai;sr([er({type:bt.GeneralizedTime})],oi.prototype,"value",void 0),oi=sr([Qt({type:wt.Choice})],oi);let ci=ai=class extends Tr{constructor(e){super(e),Object.setPrototypeOf(this,ai.prototype)}};ci=ai=sr([Qt({type:wt.Sequence})],ci);const ui="2.5.29.15";var li,pi;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(li||(li={}));class hi extends Gt{toJSON(){const e=this.toNumber(),t=[];return e&li.cRLSign&&t.push("crlSign"),e&li.dataEncipherment&&t.push("dataEncipherment"),e&li.decipherOnly&&t.push("decipherOnly"),e&li.digitalSignature&&t.push("digitalSignature"),e&li.encipherOnly&&t.push("encipherOnly"),e&li.keyAgreement&&t.push("keyAgreement"),e&li.keyCertSign&&t.push("keyCertSign"),e&li.keyEncipherment&&t.push("keyEncipherment"),e&li.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class fi{constructor(e={}){this.base=new Ar,this.minimum=0,Object.assign(this,e)}}sr([er({type:Ar})],fi.prototype,"base",void 0),sr([er({type:bt.Integer,context:0,defaultValue:0,implicit:!0})],fi.prototype,"minimum",void 0),sr([er({type:bt.Integer,context:1,optional:!0,implicit:!0})],fi.prototype,"maximum",void 0);let yi=pi=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,pi.prototype)}};yi=pi=sr([Qt({type:wt.Sequence,itemType:fi})],yi);class di{constructor(e={}){Object.assign(this,e)}}sr([er({type:yi,context:0,optional:!0,implicit:!0})],di.prototype,"permittedSubtrees",void 0),sr([er({type:yi,context:1,optional:!0,implicit:!0})],di.prototype,"excludedSubtrees",void 0);class gi{constructor(e={}){Object.assign(this,e)}}var vi;sr([er({type:bt.Integer,context:0,implicit:!0,optional:!0,converter:xt})],gi.prototype,"requireExplicitPolicy",void 0),sr([er({type:bt.Integer,context:1,implicit:!0,optional:!0,converter:xt})],gi.prototype,"inhibitPolicyMapping",void 0);class mi{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],mi.prototype,"issuerDomainPolicy",void 0),sr([er({type:bt.ObjectIdentifier})],mi.prototype,"subjectDomainPolicy",void 0);let wi=vi=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,vi.prototype)}};var bi;wi=vi=sr([Qt({type:wt.Sequence,itemType:mi})],wi);const Ai="2.5.29.17";let Si=bi=class extends Tr{constructor(e){super(e),Object.setPrototypeOf(this,bi.prototype)}};Si=bi=sr([Qt({type:wt.Sequence})],Si);class Bi{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var ki;sr([er({type:bt.ObjectIdentifier})],Bi.prototype,"type",void 0),sr([er({type:bt.Any,repeated:"set"})],Bi.prototype,"values",void 0);let xi=ki=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,ki.prototype)}};xi=ki=sr([Qt({type:wt.Sequence,itemType:Bi})],xi);const Ii="2.5.29.14";class Ci extends Ir{}class Ei{constructor(e={}){Object.assign(this,e)}}var Ni,Oi;sr([er({type:bt.GeneralizedTime,context:0,implicit:!0,optional:!0})],Ei.prototype,"notBefore",void 0),sr([er({type:bt.GeneralizedTime,context:1,implicit:!0,optional:!0})],Ei.prototype,"notAfter",void 0),function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}(Ni||(Ni={}));class Ti extends Gt{toJSON(){const e=[],t=this.toNumber();return t&Ni.pKIXCertificate&&e.push("pKIXCertificate"),t&Ni.newExtensions&&e.push("newExtensions"),t&Ni.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class Ui{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new Ti,Object.assign(this,e)}}sr([er({type:bt.GeneralString})],Ui.prototype,"entrustVers",void 0),sr([er({type:Ti})],Ui.prototype,"entrustInfoFlags",void 0);let ji=Oi=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Oi.prototype)}};ji=Oi=sr([Qt({type:wt.Sequence,itemType:Br})],ji);class Ri{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof Ri&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&a(e.parameters,this.parameters)||e.parameters===this.parameters)}}sr([er({type:bt.ObjectIdentifier})],Ri.prototype,"algorithm",void 0),sr([er({type:bt.Any,optional:!0})],Ri.prototype,"parameters",void 0);class Pi{constructor(e={}){this.algorithm=new Ri,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:Ri})],Pi.prototype,"algorithm",void 0),sr([er({type:bt.BitString})],Pi.prototype,"subjectPublicKey",void 0);let Vi=class{constructor(e){e&&("string"==typeof e||"number"==typeof e?this.utcTime=new Date(e):e instanceof Date?this.utcTime=e:Object.assign(this,e))}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};sr([er({type:bt.UTCTime})],Vi.prototype,"utcTime",void 0),sr([er({type:bt.GeneralizedTime})],Vi.prototype,"generalTime",void 0),Vi=sr([Qt({type:wt.Choice})],Vi);class Hi{constructor(e){this.notBefore=new Vi(new Date),this.notAfter=new Vi(new Date),e&&(this.notBefore=new Vi(e.notBefore),this.notAfter=new Vi(e.notAfter))}}var Li;sr([er({type:Vi})],Hi.prototype,"notBefore",void 0),sr([er({type:Vi})],Hi.prototype,"notAfter",void 0);class Di{constructor(e={}){this.extnID="",this.critical=Di.CRITICAL,this.extnValue=new Jt,Object.assign(this,e)}}Di.CRITICAL=!1,sr([er({type:bt.ObjectIdentifier})],Di.prototype,"extnID",void 0),sr([er({type:bt.Boolean,defaultValue:Di.CRITICAL})],Di.prototype,"critical",void 0),sr([er({type:Jt})],Di.prototype,"extnValue",void 0);let Mi=Li=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Li.prototype)}};var $i;Mi=Li=sr([Qt({type:wt.Sequence,itemType:Di})],Mi),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}($i||($i={}));class _i{constructor(e={}){this.version=$i.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new Ri,this.issuer=new vr,this.validity=new Hi,this.subject=new vr,this.subjectPublicKeyInfo=new Pi,Object.assign(this,e)}}sr([er({type:bt.Integer,context:0,defaultValue:$i.v1})],_i.prototype,"version",void 0),sr([er({type:bt.Integer,converter:xt})],_i.prototype,"serialNumber",void 0),sr([er({type:Ri})],_i.prototype,"signature",void 0),sr([er({type:vr})],_i.prototype,"issuer",void 0),sr([er({type:Hi})],_i.prototype,"validity",void 0),sr([er({type:vr})],_i.prototype,"subject",void 0),sr([er({type:Pi})],_i.prototype,"subjectPublicKeyInfo",void 0),sr([er({type:bt.BitString,context:1,implicit:!0,optional:!0})],_i.prototype,"issuerUniqueID",void 0),sr([er({type:bt.BitString,context:2,implicit:!0,optional:!0})],_i.prototype,"subjectUniqueID",void 0),sr([er({type:Mi,context:3,optional:!0})],_i.prototype,"extensions",void 0);class Fi{constructor(e={}){this.tbsCertificate=new _i,this.signatureAlgorithm=new Ri,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:_i})],Fi.prototype,"tbsCertificate",void 0),sr([er({type:Ri})],Fi.prototype,"signatureAlgorithm",void 0),sr([er({type:bt.BitString})],Fi.prototype,"signatureValue",void 0);class zi{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new Vi,Object.assign(this,e)}}sr([er({type:bt.Integer,converter:xt})],zi.prototype,"userCertificate",void 0),sr([er({type:Vi})],zi.prototype,"revocationDate",void 0),sr([er({type:Di,optional:!0,repeated:"sequence"})],zi.prototype,"crlEntryExtensions",void 0);class Ki{constructor(e={}){this.signature=new Ri,this.issuer=new vr,this.thisUpdate=new Vi,Object.assign(this,e)}}sr([er({type:bt.Integer,optional:!0})],Ki.prototype,"version",void 0),sr([er({type:Ri})],Ki.prototype,"signature",void 0),sr([er({type:vr})],Ki.prototype,"issuer",void 0),sr([er({type:Vi})],Ki.prototype,"thisUpdate",void 0),sr([er({type:Vi,optional:!0})],Ki.prototype,"nextUpdate",void 0),sr([er({type:zi,repeated:"sequence",optional:!0})],Ki.prototype,"revokedCertificates",void 0),sr([er({type:Di,optional:!0,context:0,repeated:"sequence"})],Ki.prototype,"crlExtensions",void 0);class qi{constructor(e={}){this.tbsCertList=new Ki,this.signatureAlgorithm=new Ri,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:Ki})],qi.prototype,"tbsCertList",void 0),sr([er({type:Ri})],qi.prototype,"signatureAlgorithm",void 0),sr([er({type:bt.BitString})],qi.prototype,"signature",void 0);class Gi{constructor(...e){if(1===e.length){const t=e[0];this.rawData=nr.serialize(t),this.onInit(t)}else{const t=nr.parse(e[0],e[1]);this.rawData=i.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof Gi&&a(e.rawData,this.rawData)}}class Ji extends Gi{constructor(...e){let t;t=i.isBufferSource(e[0])?i.toArrayBuffer(e[0]):nr.serialize(new Di({extnID:e[0],critical:e[1],extnValue:new Jt(i.toArrayBuffer(e[2]))})),super(t,Di)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}}class Wi extends Map{constructor(){super(),"undefined"!=typeof self&&"undefined"!=typeof crypto&&this.set(Wi.DEFAULT,crypto)}static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}get(e=Wi.DEFAULT){const t=super.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");super.set(e.toLowerCase(),t)}else super.set(Wi.DEFAULT,e);return this}}Wi.DEFAULT="default";const Zi=new Wi,Yi="1.2.840.113549.1.1",Xi=`${Yi}.1`,Qi=`${Yi}.7`,en=`${Yi}.9`,tn=`${Yi}.10`,rn=`${Yi}.2`,nn=`${Yi}.4`,sn=`${Yi}.5`,on=`${Yi}.11`,an=`${Yi}.12`,cn=`${Yi}.13`,un=`${Yi}.15`,ln=`${Yi}.16`,pn=`${Yi}.8`;function hn(e){return new Ri({algorithm:e,parameters:null})}hn("1.2.840.113549.2.2"),hn("1.2.840.113549.2.5");const fn=hn("1.3.14.3.2.26");hn("2.16.840.1.101.3.4.2.4"),hn("2.16.840.1.101.3.4.2.1"),hn("2.16.840.1.101.3.4.2.2"),hn("2.16.840.1.101.3.4.2.3"),hn("2.16.840.1.101.3.4.2.5"),hn("2.16.840.1.101.3.4.2.6");const yn=new Ri({algorithm:pn,parameters:nr.serialize(fn)}),dn=new Ri({algorithm:en,parameters:nr.serialize(Nt.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});hn(Xi),hn(rn),hn(nn),hn(sn),hn(un),hn(ln),hn(an),hn(cn),hn(un),hn(ln);class gn{constructor(e={}){this.hashAlgorithm=new Ri(fn),this.maskGenAlgorithm=new Ri({algorithm:pn,parameters:nr.serialize(fn)}),this.pSourceAlgorithm=new Ri(dn),Object.assign(this,e)}}sr([er({type:Ri,context:0,defaultValue:fn})],gn.prototype,"hashAlgorithm",void 0),sr([er({type:Ri,context:1,defaultValue:yn})],gn.prototype,"maskGenAlgorithm",void 0),sr([er({type:Ri,context:2,defaultValue:dn})],gn.prototype,"pSourceAlgorithm",void 0),new Ri({algorithm:Qi,parameters:nr.serialize(new gn)});class vn{constructor(e={}){this.hashAlgorithm=new Ri(fn),this.maskGenAlgorithm=new Ri({algorithm:pn,parameters:nr.serialize(fn)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}sr([er({type:Ri,context:0,defaultValue:fn})],vn.prototype,"hashAlgorithm",void 0),sr([er({type:Ri,context:1,defaultValue:yn})],vn.prototype,"maskGenAlgorithm",void 0),sr([er({type:bt.Integer,context:2,defaultValue:20})],vn.prototype,"saltLength",void 0),sr([er({type:bt.Integer,context:3,defaultValue:1})],vn.prototype,"trailerField",void 0),new Ri({algorithm:tn,parameters:nr.serialize(new vn)});class mn{constructor(e={}){this.digestAlgorithm=new Ri,this.digest=new Jt,Object.assign(this,e)}}var wn;sr([er({type:Ri})],mn.prototype,"digestAlgorithm",void 0),sr([er({type:Jt})],mn.prototype,"digest",void 0);class bn{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.Integer,converter:xt})],bn.prototype,"prime",void 0),sr([er({type:bt.Integer,converter:xt})],bn.prototype,"exponent",void 0),sr([er({type:bt.Integer,converter:xt})],bn.prototype,"coefficient",void 0);let An=wn=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,wn.prototype)}};An=wn=sr([Qt({type:wt.Sequence,itemType:bn})],An);class Sn{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.Integer})],Sn.prototype,"version",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"modulus",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"publicExponent",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"privateExponent",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"prime1",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"prime2",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"exponent1",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"exponent2",void 0),sr([er({type:bt.Integer,converter:xt})],Sn.prototype,"coefficient",void 0),sr([er({type:An,optional:!0})],Sn.prototype,"otherPrimeInfos",void 0);class Bn{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}var kn;sr([er({type:bt.Integer,converter:xt})],Bn.prototype,"modulus",void 0),sr([er({type:bt.Integer,converter:xt})],Bn.prototype,"publicExponent",void 0),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(kn||(kn={}));var xn=kn,In=function(e,t){return In=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},In(e,t)};
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */function Cn(e,t){function r(){this.constructor=e}In(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function En(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Nn(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function On(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Nn(arguments[t]));return e}function Tn(e){return!!e.useClass}function Un(e){return!!e.useFactory}var jn=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler((function(){return i||(t=e(r.wrap()),i=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t[0]=e();var n=Reflect[r];return n.apply(void 0,On(t))}})),t},e}();function Rn(e){return"string"==typeof e||"symbol"==typeof e}function Pn(e){return"object"==typeof e&&"token"in e&&"transform"in e}function Vn(e){return!!e.useToken}function Hn(e){return null!=e.useValue}var Ln=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),Dn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cn(t,e),t}(Ln),Mn=function(){this.scopedResolutions=new Map};function $n(e,t,r){var i,n,s=Nn(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],o=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===s?null:s,t);return i="Cannot inject the dependency "+o+' of "'+e.name+'" constructor. Reason:',void 0===n&&(n="    "),On([i],r.message.split("\n").map((function(e){return n+e}))).join("\n")}var _n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cn(t,e),t}(Ln),Fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Cn(t,e),t}(Ln),zn=function(){this.preResolution=new _n,this.postResolution=new Fn},Kn=new Map,qn=function(){function e(e){this.parent=e,this._registry=new Dn,this.interceptors=new zn}return e.prototype.register=function(e,t,r){var i;if(void 0===r&&(r={lifecycle:xn.Transient}),i=function(e){return Tn(e)||Hn(e)||Vn(e)||Un(e)}(t)?t:{useClass:t},Vn(i))for(var n=[e],s=i;null!=s;){var o=s.useToken;if(n.includes(o))throw new Error("Token registration cycle detected! "+On(n,[o]).join(" -> "));n.push(o);var a=this._registry.get(o);s=a&&Vn(a.provider)?a.provider:null}if((r.lifecycle===xn.Singleton||r.lifecycle==xn.ContainerScoped||r.lifecycle==xn.ResolutionScoped)&&(Hn(i)||Un(i)))throw new Error('Cannot use lifecycle "'+xn[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:r}),this},e.prototype.registerType=function(e,t){return Rn(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(Rn(e)){if(Rn(t))return this.register(e,{useToken:t},{lifecycle:xn.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:xn.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!Rn(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:xn.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new Mn);var r=this.getRegistration(e);if(!r&&Rn(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var i=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}if(function(e){return"function"==typeof e||e instanceof jn}(e)){i=this.construct(e,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,i;if(this.interceptors.preResolution.has(e)){var n=[];try{for(var s=En(this.interceptors.preResolution.getAll(e)),o=s.next();!o.done;o=s.next()){var a=o.value;"Once"!=a.options.frequency&&n.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,n)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var i,n;if(this.interceptors.postResolution.has(e)){var s=[];try{for(var o=En(this.interceptors.postResolution.getAll(e)),a=o.next();!a.done;a=o.next()){var c=a.value;"Once"!=c.options.frequency&&s.push(c),c.callback(e,t,r)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,s)}},e.prototype.resolveRegistration=function(e,t){if(e.options.lifecycle===xn.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===xn.Singleton,n=e.options.lifecycle===xn.ContainerScoped,s=i||n;return r=Hn(e.provider)?e.provider.useValue:Vn(e.provider)?s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):Tn(e.provider)?s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):Un(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===xn.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new Mn);var i=this.getAllRegistrations(e);if(!i&&Rn(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),i){var n=i.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,n,"All"),n}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;try{for(var r=En(this._registry.entries()),i=r.next();!i.done;i=r.next()){var n=Nn(i.value,2),s=n[0],o=n[1];this._registry.setAll(s,o.filter((function(e){return!Hn(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r,i=new e(this);try{for(var n=En(this._registry.entries()),s=n.next();!s.done;s=n.next()){var o=Nn(s.value,2),a=o[0],c=o[1];c.some((function(e){return e.options.lifecycle===xn.ContainerScoped}))&&i._registry.setAll(a,c.map((function(e){return e.options.lifecycle===xn.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return i},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof jn)return e.createProxy((function(e){return r.resolve(e,t)}));var i=Kn.get(e);if(!i||0===i.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var n=i.map(this.resolveParams(t,e));return new(e.bind.apply(e,On([void 0],n)))},e.prototype.resolveParams=function(e,t){var r=this;return function(i,n){var s,o,a,c;try{return"object"==typeof(c=i)&&"token"in c&&"multiple"in c?Pn(i)?i.multiple?(s=r.resolve(i.transform)).transform.apply(s,On([r.resolveAll(i.token)],i.transformArgs)):(o=r.resolve(i.transform)).transform.apply(o,On([r.resolve(i.token,e)],i.transformArgs)):i.multiple?r.resolveAll(i.token):r.resolve(i.token,e):Pn(i)?(a=r.resolve(i.transform,e)).transform.apply(a,On([r.resolve(i.token,e)],i.transformArgs)):r.resolve(i,e)}catch(e){throw new Error($n(t,n,e))}}},e}(),Gn=new qn;function Jn(){return function(e){Kn.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata("injectionTokens",e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}(e))}}if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");const Wn="crypto.algorithm";class Zn{getAlgorithms(){return Gn.resolveAll(Wn)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}if(/[0-9.]+/.test(e.name)){const t=new Ri({algorithm:e.name});if("parameters"in e){const r=e;t.parameters=r.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}}const Yn="crypto.algorithmProvider";Gn.registerSingleton(Yn,Zn);class Xn{constructor(){this.CertificateTag="CERTIFICATE",this.CertificateRequestTag="CERTIFICATE REQUEST",this.PublicKeyTag="PUBLIC KEY",this.PrivateKeyTag="PRIVATE KEY"}static isPem(e){return"string"==typeof e&&/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g.test(e)}static decode(e){const t=/-{5}BEGIN [A-Z0-9 ]+-{5}([a-zA-Z0-9=+/\n\r]+)-{5}END [A-Z0-9 ]+-{5}/g,r=[];let i=null;for(;i=t.exec(e);){const e=i[1].replace(/\r/g,"").replace(/\n/g,"");r.push(o.FromBase64(e))}return r}static encode(e,t){if(Array.isArray(e)){const r=new Array;return e.forEach((e=>{r.push(this.encodeBuffer(e,t))})),r.join("\n")}return this.encodeBuffer(e,t)}static encodeBuffer(e,t){const r=o.ToBase64(e);let i,n=0;const s=Array();for(;n<r.length&&(r.length-n<64?i=r.substring(n):(i=r.substring(n,n+64),n+=64),0!==i.length)&&(s.push(i),!(i.length<64)););const a=t.toLocaleUpperCase();return`-----BEGIN ${a}-----\n${s.join("\n")}\n-----END ${a}-----`}}class Qn extends Gi{static isAsnEncoded(e){return i.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if(Xn.isPem(e))return Xn.decode(e)[0];if(o.isHex(e))return o.FromHex(e);if(o.isBase64(e))return o.FromBase64(e);if(o.isBase64Url(e))return o.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}{const t=o.ToBinary(e);return Xn.isPem(t)?Xn.decode(t)[0]:o.isHex(t)?o.FromHex(t):o.isBase64(t)?o.FromBase64(t):o.isBase64Url(t)?o.FromBase64Url(t):i.toArrayBuffer(e)}}constructor(...e){Qn.isAsnEncoded(e[0])?super(Qn.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){switch(e){case"pem":return Xn.encode(this.rawData,this.tag);case"hex":return o.ToHex(this.rawData);case"base64":return o.ToBase64(this.rawData);case"base64url":return o.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}}class es extends Qn{constructor(e){Qn.isAsnEncoded(e)?super(e,Pi):super(e),this.tag="PUBLIC KEY"}async export(...e){let t,r=["verify"],i={hash:"SHA-256",...this.algorithm};return e.length>1?(i=e[0]||i,r=e[1]||r,t=e[2]||Zi.get()):t=e[0]||Zi.get(),t.subtle.importKey("spki",this.rawData,i,!0,r)}onInit(e){const t=Gn.resolve(Yn),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case Xi:{const t=nr.parse(e.subjectPublicKey,Bn),n=i.toUint8Array(t.modulus);r.publicExponent=i.toUint8Array(t.publicExponent),r.modulusLength=(n[0]?n:n.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,i="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(i=e[0]||i,r=e[1]||Zi.get()):r=e[0]||Zi.get(),await r.subtle.digest(i,this.rawData)}async getKeyIdentifier(e){e||(e=Zi.get());const t=nr.parse(this.rawData,Pi);return await e.subtle.digest("SHA-1",t.subjectPublicKey)}}class ts{constructor(){this.items={}}get(e){return this.items[e]||null}register(e,t){this.items[e]=t,this.items[t]=e}}const rs=new ts;function is(e,t){return`\\${o.ToHex(o.FromUtf8String(t)).toUpperCase()}`}rs.register("CN","2.5.4.3"),rs.register("L","2.5.4.7"),rs.register("ST","2.5.4.8"),rs.register("O","2.5.4.10"),rs.register("OU","2.5.4.11"),rs.register("C","2.5.4.6"),rs.register("DC","0.9.2342.19200300.100.1.25"),rs.register("E","1.2.840.113549.1.9.1"),rs.register("G","2.5.4.42"),rs.register("I","2.5.4.43"),rs.register("SN","2.5.4.4"),rs.register("T","2.5.4.12");class ns{constructor(e,t={}){this.extraNames=new ts,this.asn=new vr;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof vr?this.asn=e:i.isBufferSource(e)?this.asn=nr.parse(e,vr):this.asn=this.fromJSON(e)}static isASCII(e){for(let t=0;t<e.length;t++){if(e.charCodeAt(t)>255)return!1}return!0}getName(e){return this.extraNames.get(e)||rs.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${o.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,is)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const i={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=i[r])&&void 0!==e||(i[r]=[]),i[r].push(t.value.anyValue?`#${o.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(i)}return t}fromString(e){const t=new vr,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let i=null,n=",";for(;i=r.exec(`${e},`);){let[,e,r]=i;const s=r[r.length-1];","!==s&&"+"!==s||(r=r.slice(0,r.length-1),i[3]=s);const a=i[3];if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);const c=new yr({type:e});if("#"===r.charAt(0))c.value.anyValue=o.FromHex(r.slice(1));else{const t=/"(.*?[^\\])?"/.exec(r);t&&(r=t[1]),r=r.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1"),e===this.getName("E")||e===this.getName("DC")?c.value.ia5String=r:ns.isASCII(r)?c.value.printableString=r:c.value.utf8String=r}"+"===n?t[t.length-1].push(c):t.push(new dr([c])),n=a}return t}fromJSON(e){const t=new vr;for(const r of e){const e=new dr;for(const t in r){let i=t;if(/[\d.]+/.test(t)||(i=this.getName(t)||""),!i)throw new Error(`Cannot get OID for name type '${t}'`);const n=r[t];for(const t of n){const r=new yr({type:i});"#"===t[0]?r.value.anyValue=o.FromHex(t.slice(1)):i===this.getName("E")||i===this.getName("DC")?r.value.ia5String=t:r.value.printableString=t,e.push(r)}}t.push(e)}return t}toArrayBuffer(){return nr.serialize(this.asn)}async getThumbprint(...e){var t;let r,i="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(i=e[0]||i,r=e[1]||Zi.get()):r=e[0]||Zi.get(),await r.subtle.digest(i,this.toArrayBuffer())}}class ss{static register(e,t){this.items.set(e,t)}static create(e){const t=new Ji(e),r=this.items.get(t.type);return r?new r(e):t}}ss.items=new Map;const os="crypto.signatureFormatter";class as{toAsnSignature(e,t){return i.toArrayBuffer(t)}toWebSignature(e,t){return i.toArrayBuffer(t)}}class cs extends Qn{constructor(e){Qn.isAsnEncoded(e)?super(e,Fi):super(e),this.tag="CERTIFICATE"}onInit(e){const t=e.tbsCertificate;this.tbs=nr.serialize(t),this.serialNumber=o.ToHex(t.serialNumber),this.subjectName=new ns(t.subject),this.subject=new ns(t.subject).toString(),this.issuerName=new ns(t.issuer),this.issuer=this.issuerName.toString();const r=Gn.resolve(Yn);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const i=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!i)throw new Error("Cannot get 'notBefore' value");this.notBefore=i;const n=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!n)throw new Error("Cannot get 'notAfter' value");this.notAfter=n,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>ss.create(nr.serialize(e))))),this.publicKey=new es(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=Zi.get()){let r,i;const n=e.publicKey;try{n?n instanceof cs?(r={...n.publicKey.algorithm,...this.signatureAlgorithm},i=await n.publicKey.export(r,["verify"])):n instanceof es?(r={...n.algorithm,...this.signatureAlgorithm},i=await n.export(r,["verify"])):(r={...n.algorithm,...this.signatureAlgorithm},i=n):(r={...this.publicKey.algorithm,...this.signatureAlgorithm},i=await this.publicKey.export(r,["verify"],t))}catch(e){return!1}const s=Gn.resolveAll(os).reverse();let o=null;for(const e of s)if(o=e.toWebSignature(r,this.signature),o)break;if(!o)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const a=await t.subtle.verify(this.signatureAlgorithm,i,o,this.tbs);if(e.signatureOnly)return a;{const t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=Zi.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=Zi.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}}class us extends Ji{constructor(...e){if(i.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new Cr({keyIdentifier:new Jt(o.FromHex(e[0]))});super(xr,e[1],nr.serialize(t))}else{const t=e[0],r=new Cr({authorityCertIssuer:t.name,authorityCertSerialNumber:o.FromHex(t.serialNumber)});super(xr,e[1],nr.serialize(r))}}static async create(e,t=!1,r=Zi.get()){if(e instanceof cs||Wi.isCryptoKey(e)){const i=e instanceof cs?await e.publicKey.export(r):e,n=await r.subtle.exportKey("spki",i),s=new es(n),a=await s.getKeyIdentifier(r);return new us(o.ToHex(a),t)}return new us(e,t)}onInit(e){super.onInit(e);const t=nr.parse(e.extnValue,Cr);t.keyIdentifier&&(this.keyId=o.ToHex(t.keyIdentifier)),t.authorityCertIssuer&&t.authorityCertSerialNumber&&(this.certId={name:t.authorityCertIssuer,serialNumber:o.ToHex(t.authorityCertSerialNumber)})}}class ls extends Ji{constructor(...e){if(i.isBufferSource(e[0])){super(e[0]);const t=nr.parse(this.value,Nr);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Nr({cA:e[0],pathLenConstraint:e[1]});super(Er,e[2],nr.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}}class ps extends Ji{constructor(...e){if(i.isBufferSource(e[0])){super(e[0]);const t=nr.parse(this.value,ni);this.usages=t.map((e=>e))}else{const t=new ni(e[0]);super(ii,e[1],nr.serialize(t)),this.usages=e[0]}}}e.KeyUsageFlags=void 0,function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(e.KeyUsageFlags||(e.KeyUsageFlags={}));class hs extends Ji{constructor(...e){if(i.isBufferSource(e[0])){super(e[0]);const t=nr.parse(this.value,hi);this.usages=t.toNumber()}else{const t=new hi(e[0]);super(ui,e[1],nr.serialize(t)),this.usages=e[0]}}}class fs extends Ji{constructor(...e){if(i.isBufferSource(e[0])){super(e[0]);const t=nr.parse(this.value,Ci);this.keyId=o.ToHex(t)}else{const t="string"==typeof e[0]?o.FromHex(e[0]):e[0],r=new Ci(t);super(Ii,e[1],nr.serialize(r)),this.keyId=o.ToHex(t)}}static async create(e,t=!1,r=Zi.get()){const i=await r.subtle.exportKey("spki",e),n=new es(i),s=await n.getKeyIdentifier(r);return new fs(o.ToHex(s),t)}}class ys extends Gi{constructor(...e){let t;if(i.isBufferSource(e[0]))t=i.toArrayBuffer(e[0]);else{const r=e[0],n=i.toArrayBuffer(e[1]);t=nr.serialize(new wr({typeId:r,value:n}))}super(t,wr)}onInit(e){this.type=e.typeId,this.value=e.value}toJSON(){return{type:this.type,value:o.ToHex(this.value)}}}class ds extends Ji{constructor(...e){if(i.isBufferSource(e[0]))super(e[0]);else{const t=e[0]||{},r=new Si;for(const e of t.dns||[])r.push(new Ar({dNSName:e}));for(const e of t.email||[])r.push(new Ar({rfc822Name:e}));for(const e of t.guid||[]){const t=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(e);if(!t)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const i=t.slice(1).map(((e,t)=>t<3?o.ToHex(new Uint8Array(o.FromHex(e)).reverse()):e)).join("");r.push(new Ar({otherName:new wr({typeId:ds.GUID,value:nr.serialize(new Jt(o.FromHex(i)))})}))}for(const e of t.ip||[])r.push(new Ar({iPAddress:e}));for(const e of t.url||[])r.push(new Ar({uniformResourceIdentifier:e}));for(const e of t.upn||[])r.push(new Ar({otherName:new wr({typeId:ds.UPN,value:nr.serialize(Tt.toASN(e))})}));for(const e of t.registeredId||[])r.push(new Ar({registeredID:e}));for(const e of t.otherName||[])r.push(new Ar({otherName:new wr({typeId:e.type,value:o.FromHex(e.value)})}));super(Ai,e[1],nr.serialize(r))}}onInit(e){super.onInit(e);const t=nr.parse(e.extnValue,Si);this.dns=t.filter((e=>e.dNSName)).map((e=>e.dNSName||"")),this.email=t.filter((e=>e.rfc822Name)).map((e=>e.rfc822Name||"")),this.ip=t.filter((e=>e.iPAddress)).map((e=>e.iPAddress||"")),this.url=t.filter((e=>e.uniformResourceIdentifier)).map((e=>e.uniformResourceIdentifier||"")),this.upn=t.filter((e=>{var t;return(null===(t=e.otherName)||void 0===t?void 0:t.typeId)===ds.UPN})).map((e=>e.otherName?nr.parse(e.otherName.value,hr).toString():"")),this.guid=t.filter((e=>{var t;return(null===(t=e.otherName)||void 0===t?void 0:t.typeId)===ds.GUID})).map((e=>e.otherName?nr.parse(e.otherName.value,Jt):new Jt)).map((e=>{const t=/([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})/i.exec(o.ToHex(e));if(!t)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const r=t.slice(1).map(((e,t)=>t<3?o.ToHex(new Uint8Array(o.FromHex(e)).reverse()):e)).join("-");return`{${r}}`})),this.registeredId=t.filter((e=>e.registeredID)).map((e=>e.registeredID||"")),this.otherNames=t.filter((e=>e.otherName&&![ds.GUID,ds.UPN].includes(e.otherName.typeId))).map((e=>new ys(e.otherName.typeId,e.otherName.value)))}toJSON(){const e={};return this.dns.length&&(e.dns=[...this.dns]),this.email.length&&(e.email=[...this.email]),this.ip.length&&(e.ip=[...this.ip]),this.guid.length&&(e.guid=[...this.guid]),this.upn.length&&(e.upn=[...this.upn]),this.url.length&&(e.url=[...this.url]),this.registeredId.length&&(e.registeredId=[...this.registeredId]),this.otherNames.length&&(e.otherName=this.otherNames.map((e=>e.toJSON()))),e}}ds.GUID="1.3.6.1.4.1.311.25.1",ds.UPN="1.3.6.1.4.1.311.20.2.3";class gs extends Ji{constructor(...e){var t;if(i.isBufferSource(e[0])){super(e[0]);const t=nr.parse(this.value,_r);this.policies=t.map((e=>e.policyIdentifier))}else{const r=e[0],i=null!==(t=e[1])&&void 0!==t&&t,n=new _r(r.map((e=>new $r({policyIdentifier:e}))));super(Pr,i,nr.serialize(n)),this.policies=r}}}ss.register(Pr,gs);class vs{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],vs.prototype,"attrType",void 0),sr([er({type:bt.Any,repeated:"set"})],vs.prototype,"attrValues",void 0);class ms{constructor(e={}){this.acIssuer=new Ar,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}var ws;sr([er({type:Ar})],ms.prototype,"acIssuer",void 0),sr([er({type:bt.Integer})],ms.prototype,"acSerial",void 0),sr([er({type:Bi,repeated:"sequence"})],ms.prototype,"attrs",void 0);let bs=ws=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,ws.prototype)}};bs=ws=sr([Qt({type:wt.Sequence,itemType:bt.ObjectIdentifier})],bs);class As{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}sr([er({type:bt.Integer,optional:!0})],As.prototype,"pathLenConstraint",void 0),sr([er({type:bs,implicit:!0,context:0,optional:!0})],As.prototype,"permittedAttrs",void 0),sr([er({type:bs,implicit:!0,context:1,optional:!0})],As.prototype,"excludedAttrs",void 0),sr([er({type:bt.Boolean,defaultValue:!0})],As.prototype,"permitUnSpecified",void 0);class Ss{constructor(e={}){this.issuer=new Tr,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var Bs;sr([er({type:Tr})],Ss.prototype,"issuer",void 0),sr([er({type:bt.Integer,converter:xt})],Ss.prototype,"serial",void 0),sr([er({type:bt.BitString,optional:!0})],Ss.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(Bs||(Bs={}));class ks{constructor(e={}){this.digestedObjectType=Bs.publicKey,this.digestAlgorithm=new Ri,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.Enumerated})],ks.prototype,"digestedObjectType",void 0),sr([er({type:bt.ObjectIdentifier,optional:!0})],ks.prototype,"otherObjectTypeID",void 0),sr([er({type:Ri})],ks.prototype,"digestAlgorithm",void 0),sr([er({type:bt.BitString})],ks.prototype,"objectDigest",void 0);class xs{constructor(e={}){Object.assign(this,e)}}sr([er({type:Tr,optional:!0})],xs.prototype,"issuerName",void 0),sr([er({type:Ss,context:0,implicit:!0,optional:!0})],xs.prototype,"baseCertificateID",void 0),sr([er({type:ks,context:1,implicit:!0,optional:!0})],xs.prototype,"objectDigestInfo",void 0);let Is=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:Ar,repeated:"sequence"})],Is.prototype,"v1Form",void 0),sr([er({type:xs,context:0,implicit:!0})],Is.prototype,"v2Form",void 0),Is=sr([Qt({type:wt.Choice})],Is);class Cs{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}sr([er({type:bt.GeneralizedTime})],Cs.prototype,"notBeforeTime",void 0),sr([er({type:bt.GeneralizedTime})],Cs.prototype,"notAfterTime",void 0);class Es{constructor(e={}){Object.assign(this,e)}}var Ns,Os,Ts;sr([er({type:Ss,implicit:!0,context:0,optional:!0})],Es.prototype,"baseCertificateID",void 0),sr([er({type:Tr,implicit:!0,context:1,optional:!0})],Es.prototype,"entityName",void 0),sr([er({type:ks,implicit:!0,context:2,optional:!0})],Es.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(Ns||(Ns={}));class Us{constructor(e={}){this.version=Ns.v2,this.holder=new Es,this.issuer=new Is,this.signature=new Ri,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new Cs,this.attributes=[],Object.assign(this,e)}}sr([er({type:bt.Integer})],Us.prototype,"version",void 0),sr([er({type:Es})],Us.prototype,"holder",void 0),sr([er({type:Is})],Us.prototype,"issuer",void 0),sr([er({type:Ri})],Us.prototype,"signature",void 0),sr([er({type:bt.Integer,converter:xt})],Us.prototype,"serialNumber",void 0),sr([er({type:Cs})],Us.prototype,"attrCertValidityPeriod",void 0),sr([er({type:Bi,repeated:"sequence"})],Us.prototype,"attributes",void 0),sr([er({type:bt.BitString,optional:!0})],Us.prototype,"issuerUniqueID",void 0),sr([er({type:Mi,optional:!0})],Us.prototype,"extensions",void 0);class js{constructor(e={}){this.acinfo=new Us,this.signatureAlgorithm=new Ri,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:Us})],js.prototype,"acinfo",void 0),sr([er({type:Ri})],js.prototype,"signatureAlgorithm",void 0),sr([er({type:bt.BitString})],js.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(Os||(Os={}));class Rs extends Gt{}class Ps{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier,implicit:!0,context:0})],Ps.prototype,"type",void 0),sr([er({type:bt.Any,implicit:!0,context:1})],Ps.prototype,"value",void 0);class Vs{constructor(e={}){this.policyId="",this.classList=new Rs(Os.unclassified),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Vs.prototype,"policyId",void 0),sr([er({type:Rs,defaultValue:new Rs(Os.unclassified)})],Vs.prototype,"classList",void 0),sr([er({type:Ps,repeated:"set"})],Vs.prototype,"securityCategories",void 0);class Hs{constructor(e={}){Object.assign(this,e)}}sr([er({type:Jt})],Hs.prototype,"cotets",void 0),sr([er({type:bt.ObjectIdentifier})],Hs.prototype,"oid",void 0),sr([er({type:bt.Utf8String})],Hs.prototype,"string",void 0);class Ls{constructor(e={}){this.values=[],Object.assign(this,e)}}sr([er({type:Tr,implicit:!0,context:0,optional:!0})],Ls.prototype,"policyAuthority",void 0),sr([er({type:Hs,repeated:"sequence"})],Ls.prototype,"values",void 0);class Ds{constructor(e={}){this.targetCertificate=new Ss,Object.assign(this,e)}}sr([er({type:Ss})],Ds.prototype,"targetCertificate",void 0),sr([er({type:Ar,optional:!0})],Ds.prototype,"targetName",void 0),sr([er({type:ks,optional:!0})],Ds.prototype,"certDigestInfo",void 0);let Ms=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:Ar,context:0,implicit:!0})],Ms.prototype,"targetName",void 0),sr([er({type:Ar,context:1,implicit:!0})],Ms.prototype,"targetGroup",void 0),sr([er({type:Ds,context:2,implicit:!0})],Ms.prototype,"targetCert",void 0),Ms=sr([Qt({type:wt.Choice})],Ms);let $s=Ts=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Ts.prototype)}};var _s;$s=Ts=sr([Qt({type:wt.Sequence,itemType:Ms})],$s);let Fs=_s=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,_s.prototype)}};Fs=_s=sr([Qt({type:wt.Sequence,itemType:$s})],Fs);class zs{constructor(e={}){Object.assign(this,e)}}sr([er({type:Tr,implicit:!0,context:0,optional:!0})],zs.prototype,"roleAuthority",void 0),sr([er({type:Ar,implicit:!0,context:1})],zs.prototype,"roleName",void 0);class Ks{constructor(e={}){this.service=new Ar,this.ident=new Ar,Object.assign(this,e)}}var qs;sr([er({type:Ar})],Ks.prototype,"service",void 0),sr([er({type:Ar})],Ks.prototype,"ident",void 0),sr([er({type:Jt,optional:!0})],Ks.prototype,"authInfo",void 0);class Gs{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Gs.prototype,"otherCertFormat",void 0),sr([er({type:bt.Any})],Gs.prototype,"otherCert",void 0);let Js=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:Fi})],Js.prototype,"certificate",void 0),sr([er({type:js,context:2,implicit:!0})],Js.prototype,"v2AttrCert",void 0),sr([er({type:Gs,context:3,implicit:!0})],Js.prototype,"other",void 0),Js=sr([Qt({type:wt.Choice})],Js);let Ws=qs=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,qs.prototype)}};Ws=qs=sr([Qt({type:wt.Set,itemType:Js})],Ws);class Zs{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Zs.prototype,"contentType",void 0),sr([er({type:bt.Any,context:0})],Zs.prototype,"content",void 0);let Ys=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:Jt})],Ys.prototype,"single",void 0),sr([er({type:bt.Any})],Ys.prototype,"any",void 0),Ys=sr([Qt({type:wt.Choice})],Ys);class Xs{constructor(e={}){this.eContentType="",Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Xs.prototype,"eContentType",void 0),sr([er({type:Ys,context:0,optional:!0})],Xs.prototype,"eContent",void 0);class Qs{constructor(e={}){this.issuer=new vr,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:vr})],Qs.prototype,"issuer",void 0),sr([er({type:bt.Integer,converter:xt})],Qs.prototype,"serialNumber",void 0);const eo="1.2.840.113549.1.7.2";var to;class ro{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],ro.prototype,"otherRevInfoFormat",void 0),sr([er({type:bt.Any})],ro.prototype,"otherRevInfo",void 0);let io=class{constructor(e={}){this.other=new ro,Object.assign(this,e)}};sr([er({type:ro,context:1,implicit:!0})],io.prototype,"other",void 0),io=sr([Qt({type:wt.Choice})],io);let no=to=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,to.prototype)}};var so;no=to=sr([Qt({type:wt.Set,itemType:io})],no),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(so||(so={}));let oo=class extends Ri{};oo=sr([Qt({type:wt.Sequence})],oo);let ao=class extends Ri{};ao=sr([Qt({type:wt.Sequence})],ao);let co=class{constructor(e={}){Object.assign(this,e)}};var uo;sr([er({type:Ci,context:0,implicit:!0})],co.prototype,"subjectKeyIdentifier",void 0),sr([er({type:Qs})],co.prototype,"issuerAndSerialNumber",void 0),co=sr([Qt({type:wt.Choice})],co);class lo{constructor(e={}){this.version=so.v0,this.sid=new co,this.digestAlgorithm=new oo,this.signatureAlgorithm=new ao,this.signature=new Jt,Object.assign(this,e)}}sr([er({type:bt.Integer})],lo.prototype,"version",void 0),sr([er({type:co})],lo.prototype,"sid",void 0),sr([er({type:oo})],lo.prototype,"digestAlgorithm",void 0),sr([er({type:vs,repeated:"set",context:0,implicit:!0,optional:!0})],lo.prototype,"signedAttrs",void 0),sr([er({type:ao})],lo.prototype,"signatureAlgorithm",void 0),sr([er({type:Jt})],lo.prototype,"signature",void 0),sr([er({type:vs,repeated:"set",context:1,implicit:!0,optional:!0})],lo.prototype,"unsignedAttrs",void 0);let po=uo=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,uo.prototype)}};var ho;po=uo=sr([Qt({type:wt.Set,itemType:lo})],po);let fo=ho=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,ho.prototype)}};fo=ho=sr([Qt({type:wt.Set,itemType:oo})],fo);class yo{constructor(e={}){this.version=so.v0,this.digestAlgorithms=new fo,this.encapContentInfo=new Xs,this.signerInfos=new po,Object.assign(this,e)}}var go;sr([er({type:bt.Integer})],yo.prototype,"version",void 0),sr([er({type:fo})],yo.prototype,"digestAlgorithms",void 0),sr([er({type:Xs})],yo.prototype,"encapContentInfo",void 0),sr([er({type:Ws,context:0,implicit:!0,optional:!0})],yo.prototype,"certificates",void 0),sr([er({type:io,context:1,implicit:!0,optional:!0})],yo.prototype,"crls",void 0),sr([er({type:po})],yo.prototype,"signerInfos",void 0);class vo{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}sr([er({type:bt.ObjectIdentifier})],vo.prototype,"attrId",void 0),sr([er({type:bt.Any,repeated:"set"})],vo.prototype,"attrValues",void 0);let mo=go=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,go.prototype)}};var wo;mo=go=sr([Qt({type:wt.Sequence,itemType:vo})],mo);let bo=wo=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,wo.prototype)}};bo=wo=sr([Qt({type:wt.Sequence,itemType:Zs})],bo);class Ao{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Ao.prototype,"certId",void 0),sr([er({type:bt.Any,context:0})],Ao.prototype,"certValue",void 0);class So{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],So.prototype,"crlId",void 0),sr([er({type:bt.Any,context:0})],So.prototype,"crltValue",void 0);class Bo extends Jt{}class ko{constructor(e={}){this.encryptionAlgorithm=new Ri,this.encryptedData=new Bo,Object.assign(this,e)}}var xo,Io;sr([er({type:Ri})],ko.prototype,"encryptionAlgorithm",void 0),sr([er({type:Bo})],ko.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(Io||(Io={}));class Co extends Jt{}let Eo=xo=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,xo.prototype)}};Eo=xo=sr([Qt({type:wt.Sequence,itemType:Bi})],Eo);class No{constructor(e={}){this.version=Io.v1,this.privateKeyAlgorithm=new Ri,this.privateKey=new Co,Object.assign(this,e)}}sr([er({type:bt.Integer})],No.prototype,"version",void 0),sr([er({type:Ri})],No.prototype,"privateKeyAlgorithm",void 0),sr([er({type:Co})],No.prototype,"privateKey",void 0),sr([er({type:Eo,implicit:!0,context:0,optional:!0})],No.prototype,"attributes",void 0);let Oo=class extends No{};Oo=sr([Qt({type:wt.Sequence})],Oo);let To=class extends ko{};To=sr([Qt({type:wt.Sequence})],To);class Uo{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Uo.prototype,"secretTypeId",void 0),sr([er({type:bt.Any,context:0})],Uo.prototype,"secretValue",void 0);class jo{constructor(e={}){this.mac=new mn,this.macSalt=new Jt,this.iterations=1,Object.assign(this,e)}}sr([er({type:mn})],jo.prototype,"mac",void 0),sr([er({type:Jt})],jo.prototype,"macSalt",void 0),sr([er({type:bt.Integer,defaultValue:1})],jo.prototype,"iterations",void 0);class Ro{constructor(e={}){this.version=3,this.authSafe=new Zs,this.macData=new jo,Object.assign(this,e)}}var Po;sr([er({type:bt.Integer})],Ro.prototype,"version",void 0),sr([er({type:Zs})],Ro.prototype,"authSafe",void 0),sr([er({type:jo,optional:!0})],Ro.prototype,"macData",void 0);class Vo{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:bt.ObjectIdentifier})],Vo.prototype,"bagId",void 0),sr([er({type:bt.Any,context:0})],Vo.prototype,"bagValue",void 0),sr([er({type:vo,repeated:"set",optional:!0})],Vo.prototype,"bagAttributes",void 0);let Ho=Po=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Po.prototype)}};var Lo,Do,Mo;Ho=Po=sr([Qt({type:wt.Sequence,itemType:Vo})],Ho);const $o="1.2.840.113549.1.9",_o=`${$o}.7`,Fo=`${$o}.14`;let zo=class extends hr{constructor(e={}){super(e)}toString(){return this.ia5String||super.toString()}};sr([er({type:bt.IA5String})],zo.prototype,"ia5String",void 0),zo=sr([Qt({type:wt.Choice})],zo);let Ko=class extends Zs{};Ko=sr([Qt({type:wt.Sequence})],Ko);let qo=class extends Ro{};qo=sr([Qt({type:wt.Sequence})],qo);let Go=class extends ko{};Go=sr([Qt({type:wt.Sequence})],Go);let Jo=class{constructor(e=""){this.value=e}toString(){return this.value}};sr([er({type:bt.IA5String})],Jo.prototype,"value",void 0),Jo=sr([Qt({type:wt.Choice})],Jo);let Wo=class extends zo{};Wo=sr([Qt({type:wt.Choice})],Wo);let Zo=class extends hr{};Zo=sr([Qt({type:wt.Choice})],Zo);let Yo=class{constructor(e=new Date){this.value=e}};sr([er({type:bt.GeneralizedTime})],Yo.prototype,"value",void 0),Yo=sr([Qt({type:wt.Choice})],Yo);let Xo=class extends hr{};Xo=sr([Qt({type:wt.Choice})],Xo);let Qo=class{constructor(e="M"){this.value=e}toString(){return this.value}};sr([er({type:bt.PrintableString})],Qo.prototype,"value",void 0),Qo=sr([Qt({type:wt.Choice})],Qo);let ea=class{constructor(e=""){this.value=e}toString(){return this.value}};sr([er({type:bt.PrintableString})],ea.prototype,"value",void 0),ea=sr([Qt({type:wt.Choice})],ea);let ta=class extends ea{};ta=sr([Qt({type:wt.Choice})],ta);let ra=class extends hr{};ra=sr([Qt({type:wt.Choice})],ra);let ia=class{constructor(e=""){this.value=e}toString(){return this.value}};sr([er({type:bt.ObjectIdentifier})],ia.prototype,"value",void 0),ia=sr([Qt({type:wt.Choice})],ia);let na=class extends Vi{};na=sr([Qt({type:wt.Choice})],na);let sa=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};sr([er({type:bt.Integer})],sa.prototype,"value",void 0),sa=sr([Qt({type:wt.Choice})],sa);let oa=class extends lo{};oa=sr([Qt({type:wt.Sequence})],oa);let aa=class extends hr{};aa=sr([Qt({type:wt.Choice})],aa);let ca=Lo=class extends Mi{constructor(e){super(e),Object.setPrototypeOf(this,Lo.prototype)}};ca=Lo=sr([Qt({type:wt.Sequence})],ca);let ua=Do=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Do.prototype)}};ua=Do=sr([Qt({type:wt.Set,itemType:vs})],ua);let la=class{constructor(e=""){this.value=e}toString(){return this.value}};sr([er({type:bt.BmpString})],la.prototype,"value",void 0),la=sr([Qt({type:wt.Choice})],la);let pa=class extends Ri{};pa=sr([Qt({type:wt.Sequence})],pa);let ha=Mo=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,Mo.prototype)}};ha=Mo=sr([Qt({type:wt.Sequence,itemType:pa})],ha);class fa extends Gi{constructor(...e){let t;if(i.isBufferSource(e[0]))t=i.toArrayBuffer(e[0]);else{const r=e[0],n=Array.isArray(e[1])?e[1].map((e=>i.toArrayBuffer(e))):[];t=nr.serialize(new Bi({type:r,values:n}))}super(t,Bi)}onInit(e){this.type=e.type,this.values=e.values}}class ya extends fa{constructor(...e){var t;if(i.isBufferSource(e[0]))super(e[0]);else{const t=new aa({printableString:e[0]});super(_o,[nr.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=nr.parse(this.values[0],aa);this.password=e.toString()}}}class da extends fa{constructor(...e){var t;if(i.isBufferSource(e[0]))super(e[0]);else{const t=new Mi(e[0]);super(Fo,[nr.serialize(t)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=nr.parse(this.values[0],Mi);this.items=e.map((e=>ss.create(nr.serialize(e))))}}}class ga{static register(e,t){this.items.set(e,t)}static create(e){const t=new fa(e),r=this.items.get(t.type);return r?new r(e):t}}ga.items=new Map,e.RsaAlgorithm=class{toAsnAlgorithm(e){if("rsassa-pkcs1-v1_5"===e.name.toLowerCase()){if(!e.hash)return new Ri({algorithm:Xi,parameters:null});switch(e.hash.name.toLowerCase()){case"sha-1":return new Ri({algorithm:sn,parameters:null});case"sha-256":return new Ri({algorithm:on,parameters:null});case"sha-384":return new Ri({algorithm:an,parameters:null});case"sha-512":return new Ri({algorithm:cn,parameters:null})}}return null}toWebAlgorithm(e){switch(e.algorithm){case Xi:return{name:"RSASSA-PKCS1-v1_5"};case sn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case on:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case an:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case cn:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}}}return null}},e.RsaAlgorithm=sr([Jn()],e.RsaAlgorithm),Gn.registerSingleton(Wn,e.RsaAlgorithm);const va="1.2.840.10045.2.1",ma="1.2.840.10045.4.1",wa="1.2.840.10045.4.3.2",ba="1.2.840.10045.4.3.3",Aa="1.2.840.10045.4.3.4",Sa="1.2.840.10045.3.1.7",Ba="1.3.132.0.34",ka="1.3.132.0.35";function xa(e){return new Ri({algorithm:e})}const Ia=xa(ma);xa("1.2.840.10045.4.3.1");const Ca=xa(wa),Ea=xa(ba),Na=xa(Aa);let Oa=class{constructor(e={}){Object.assign(this,e)}};sr([er({type:bt.ObjectIdentifier})],Oa.prototype,"namedCurve",void 0),Oa=sr([Qt({type:wt.Choice})],Oa);class Ta{constructor(e={}){this.version=1,this.privateKey=new Jt,Object.assign(this,e)}}sr([er({type:bt.Integer})],Ta.prototype,"version",void 0),sr([er({type:Jt})],Ta.prototype,"privateKey",void 0),sr([er({type:Oa,context:0,optional:!0})],Ta.prototype,"parameters",void 0),sr([er({type:bt.BitString,context:1,optional:!0})],Ta.prototype,"publicKey",void 0);class Ua{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}var ja;sr([er({type:bt.Integer,converter:xt})],Ua.prototype,"r",void 0),sr([er({type:bt.Integer,converter:xt})],Ua.prototype,"s",void 0);const Ra="1.3.36.3.3.2.8.1.1",Pa=`${Ra}.1`,Va=`${Ra}.2`,Ha=`${Ra}.3`,La=`${Ra}.4`,Da=`${Ra}.5`,Ma=`${Ra}.6`,$a=`${Ra}.7`,_a=`${Ra}.8`,Fa=`${Ra}.9`,za=`${Ra}.10`,Ka=`${Ra}.11`,qa=`${Ra}.12`,Ga=`${Ra}.13`,Ja=`${Ra}.14`,Wa="brainpoolP160r1",Za="brainpoolP160t1",Ya="brainpoolP192r1",Xa="brainpoolP192t1",Qa="brainpoolP224r1",ec="brainpoolP224t1",tc="brainpoolP256r1",rc="brainpoolP256t1",ic="brainpoolP320r1",nc="brainpoolP320t1",sc="brainpoolP384r1",oc="brainpoolP384t1",ac="brainpoolP512r1",cc="brainpoolP512t1",uc="ECDSA";e.EcAlgorithm=ja=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===uc.toLowerCase())if("hash"in e){switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return Ia;case"sha-256":return Ca;case"sha-384":return Ea;case"sha-512":return Na}}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=Sa;break;case"K-256":t=ja.SECP256K1;break;case"P-384":t=Ba;break;case"P-521":t=ka;break;case Wa:t=Pa;break;case Za:t=Va;break;case Ya:t=Ha;break;case Xa:t=La;break;case Qa:t=Da;break;case ec:t=Ma;break;case tc:t=$a;break;case rc:t=_a;break;case ic:t=Fa;break;case nc:t=za;break;case sc:t=Ka;break;case oc:t=qa;break;case ac:t=Ga;break;case cc:t=Ja}if(t)return new Ri({algorithm:va,parameters:nr.serialize(new Oa({namedCurve:t}))})}return null}toWebAlgorithm(e){switch(e.algorithm){case ma:return{name:uc,hash:{name:"SHA-1"}};case wa:return{name:uc,hash:{name:"SHA-256"}};case ba:return{name:uc,hash:{name:"SHA-384"}};case Aa:return{name:uc,hash:{name:"SHA-512"}};case va:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(nr.parse(e.parameters,Oa).namedCurve){case Sa:return{name:uc,namedCurve:"P-256"};case ja.SECP256K1:return{name:uc,namedCurve:"K-256"};case Ba:return{name:uc,namedCurve:"P-384"};case ka:return{name:uc,namedCurve:"P-521"};case Pa:return{name:uc,namedCurve:Wa};case Va:return{name:uc,namedCurve:Za};case Ha:return{name:uc,namedCurve:Ya};case La:return{name:uc,namedCurve:Xa};case Da:return{name:uc,namedCurve:Qa};case Ma:return{name:uc,namedCurve:ec};case $a:return{name:uc,namedCurve:tc};case _a:return{name:uc,namedCurve:rc};case Fa:return{name:uc,namedCurve:ic};case za:return{name:uc,namedCurve:nc};case Ka:return{name:uc,namedCurve:sc};case qa:return{name:uc,namedCurve:oc};case Ga:return{name:uc,namedCurve:ac};case Ja:return{name:uc,namedCurve:cc}}}return null}},e.EcAlgorithm.SECP256K1="1.3.132.0.10",e.EcAlgorithm=ja=sr([Jn()],e.EcAlgorithm),Gn.registerSingleton(Wn,e.EcAlgorithm);class lc{addPadding(e,t){const r=i.toUint8Array(t),n=new Uint8Array(e);return n.set(r,e-r.length),n}removePadding(e,t=!1){let r=i.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){const e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,n=lc.namedCurveSize.get(r)||lc.defaultNamedCurveSize,s=new Ua,o=i.toUint8Array(t);return s.r=this.removePadding(o.slice(0,n),!0),s.s=this.removePadding(o.slice(n,n+n),!0),nr.serialize(s)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=nr.parse(t,Ua),i=e.namedCurve,n=lc.namedCurveSize.get(i)||lc.defaultNamedCurveSize;return function(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let i=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[i++]=t})),r.buffer}(this.addPadding(n,this.removePadding(r.r)),this.addPadding(n,this.removePadding(r.s)))}return null}}lc.namedCurveSize=new Map,lc.defaultNamedCurveSize=32;const pc="1.3.101.110",hc="1.3.101.111",fc="1.3.101.112",yc="1.3.101.113";var dc;e.EdAlgorithm=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=fc;break;case"ed448":t=yc}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=pc;break;case"x448":t=hc}}return t?new Ri({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case fc:return{name:"EdDSA",namedCurve:"Ed25519"};case yc:return{name:"EdDSA",namedCurve:"Ed448"};case pc:return{name:"ECDH-ES",namedCurve:"X25519"};case hc:return{name:"ECDH-ES",namedCurve:"X448"}}return null}},e.EdAlgorithm=sr([Jn()],e.EdAlgorithm),Gn.registerSingleton(Wn,e.EdAlgorithm);let gc=dc=class extends ir{constructor(e){super(e),Object.setPrototypeOf(this,dc.prototype)}};gc=dc=sr([Qt({type:wt.Sequence,itemType:Bi})],gc);class vc{constructor(e={}){this.version=0,this.subject=new vr,this.subjectPKInfo=new Pi,this.attributes=new gc,Object.assign(this,e)}}sr([er({type:bt.Integer})],vc.prototype,"version",void 0),sr([er({type:vr})],vc.prototype,"subject",void 0),sr([er({type:Pi})],vc.prototype,"subjectPKInfo",void 0),sr([er({type:gc,implicit:!0,context:0})],vc.prototype,"attributes",void 0);class mc{constructor(e={}){this.certificationRequestInfo=new vc,this.signatureAlgorithm=new Ri,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}sr([er({type:vc})],mc.prototype,"certificationRequestInfo",void 0),sr([er({type:Ri})],mc.prototype,"signatureAlgorithm",void 0),sr([er({type:bt.BitString})],mc.prototype,"signature",void 0);class wc extends Qn{constructor(e){Qn.isAsnEncoded(e)?super(e,mc):super(e),this.tag="CERTIFICATE REQUEST"}onInit(e){this.tbs=nr.serialize(e.certificationRequestInfo),this.publicKey=new es(e.certificationRequestInfo.subjectPKInfo);const t=Gn.resolve(Yn);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>ga.create(nr.serialize(e))));const r=this.getAttribute(Fo);this.extensions=[],r instanceof da&&(this.extensions=r.items),this.subjectName=new ns(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=Zi.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),i=Gn.resolveAll(os).reverse();let n=null;for(const e of i)if(n=e.toWebSignature(t,this.signature),n)break;if(!n)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,n,this.tbs)}}class bc extends Array{constructor(e){if(super(),Qn.isAsnEncoded(e))this.import(e);else if(e instanceof cs)this.push(e);else if(Array.isArray(e))for(const t of e)this.push(t)}export(e){const t=new yo;t.certificates=new Ws(this.map((e=>new Js({certificate:nr.parse(e.rawData,Fi)}))));const r=new Zs({contentType:eo,content:nr.serialize(t)}),i=nr.serialize(r);return"raw"===e?i:this.toString(e)}import(e){const t=Qn.toArrayBuffer(e),r=nr.parse(t,Zs);if(r.contentType!==eo)throw new TypeError("Cannot parse CMS package. Incoming data is not a SignedData object.");const i=nr.parse(r.content,yo);this.clear();for(const e of i.certificates||[])e.certificate&&this.push(new cs(e.certificate))}clear(){for(;this.pop(););}toString(e="pem"){const t=this.export("raw");switch(e){case"pem":return Xn.encode(t,"CMS");case"hex":return o.ToHex(t);case"base64":return o.ToBase64(t);case"base64url":return o.ToBase64Url(t);default:throw TypeError("Argument 'format' is unsupported value")}}}return ss.register(Er,ls),ss.register(ii,ps),ss.register(ui,hs),ss.register(Ii,fs),ss.register(xr,us),ss.register(Ai,ds),ga.register(_o,ya),ga.register(Fo,da),Gn.registerSingleton(os,as),Gn.registerSingleton(os,lc),lc.namedCurveSize.set("P-256",32),lc.namedCurveSize.set("K-256",32),lc.namedCurveSize.set("P-384",48),lc.namedCurveSize.set("P-521",66),e.AlgorithmProvider=Zn,e.AsnData=Gi,e.AsnDefaultSignatureFormatter=as,e.AsnEcSignatureFormatter=lc,e.Attribute=fa,e.AttributeFactory=ga,e.AuthorityKeyIdentifierExtension=us,e.BasicConstraintsExtension=ls,e.CertificatePolicyExtension=gs,e.ChallengePasswordAttribute=ya,e.CryptoProvider=Wi,e.ExtendedKeyUsageExtension=ps,e.Extension=Ji,e.ExtensionFactory=ss,e.ExtensionsAttribute=da,e.KeyUsagesExtension=hs,e.Name=ns,e.NameIdentifier=ts,e.OtherName=ys,e.PemConverter=Xn,e.Pkcs10CertificateRequest=wc,e.Pkcs10CertificateRequestGenerator=class{static async create(e,t=Zi.get()){if(!e.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");const r=await t.subtle.exportKey("spki",e.keys.publicKey),i=new mc({certificationRequestInfo:new vc({subjectPKInfo:nr.parse(r,Pi)})});if(e.name){const t=e.name instanceof ns?e.name:new ns(e.name);i.certificationRequestInfo.subject=nr.parse(t.toArrayBuffer(),vr)}if(e.attributes)for(const t of e.attributes)i.certificationRequestInfo.attributes.push(nr.parse(t.rawData,Bi));if(e.extensions&&e.extensions.length){const t=new Bi({type:Fo}),r=new Mi;for(const t of e.extensions)r.push(nr.parse(t.rawData,Di));t.values.push(nr.serialize(r)),i.certificationRequestInfo.attributes.push(t)}const n={...e.signingAlgorithm,...e.keys.privateKey.algorithm},s=Gn.resolve(Yn);i.signatureAlgorithm=s.toAsnAlgorithm(n);const o=nr.serialize(i.certificationRequestInfo),a=await t.subtle.sign(n,e.keys.privateKey,o),c=Gn.resolveAll(os).reverse();let u=null;for(const e of c)if(u=e.toAsnSignature(n,a),u)break;if(!u)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return i.signature=u,new wc(nr.serialize(i))}},e.PublicKey=es,e.SubjectAlternativeNameExtension=ds,e.SubjectKeyIdentifierExtension=fs,e.X509Certificate=cs,e.X509CertificateGenerator=class{static async createSelfSigned(e,t=Zi.get()){if(!e.keys.privateKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");if(!e.keys.publicKey)throw new Error("Bad field 'keys' in 'params' argument. 'privateKey' is empty");return this.create({serialNumber:e.serialNumber,subject:e.name,issuer:e.name,notBefore:e.notBefore,notAfter:e.notAfter,publicKey:e.keys.publicKey,signingKey:e.keys.privateKey,signingAlgorithm:e.signingAlgorithm,extensions:e.extensions},t)}static async create(e,t=Zi.get()){var r;const i=await t.subtle.exportKey("spki",e.publicKey),n=new Fi({tbsCertificate:new _i({version:$i.v3,serialNumber:o.FromHex(e.serialNumber),validity:new Hi({notBefore:e.notBefore,notAfter:e.notAfter}),extensions:new Mi((null===(r=e.extensions)||void 0===r?void 0:r.map((e=>nr.parse(e.rawData,Di))))||[]),subjectPublicKeyInfo:nr.parse(i,Pi)})});if(e.subject){const t=e.subject instanceof ns?e.subject:new ns(e.subject);n.tbsCertificate.subject=nr.parse(t.toArrayBuffer(),vr)}if(e.issuer){const t=e.issuer instanceof ns?e.issuer:new ns(e.issuer);n.tbsCertificate.issuer=nr.parse(t.toArrayBuffer(),vr)}const s={...e.signingAlgorithm,...e.signingKey.algorithm},a=Gn.resolve(Yn);n.tbsCertificate.signature=n.signatureAlgorithm=a.toAsnAlgorithm(s);const c=nr.serialize(n.tbsCertificate),u=await t.subtle.sign(s,e.signingKey,c),l=Gn.resolveAll(os).reverse();let p=null;for(const e of l)if(p=e.toAsnSignature(s,u),p)break;if(!p)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");return n.signatureValue=p,new cs(nr.serialize(n))}},e.X509Certificates=bc,e.X509ChainBuilder=class{constructor(e={}){this.certificates=[],e.certificates&&(this.certificates=e.certificates)}async build(e,t=Zi.get()){const r=new bc(e);let i=e;for(;i=await this.findIssuer(i,t);){const e=await i.getThumbprint(t);for(const i of r){if(a(e,await i.getThumbprint(t)))throw new Error("Cannot build a certificate chain. Circular dependency.")}r.push(i)}return r}async findIssuer(e,t=Zi.get()){if(!await e.isSelfSigned(t)){const r=e.getExtension(xr);for(const i of this.certificates)if(i.subject===e.issuer){if(r)if(r.keyId){const e=i.getExtension(Ii);if(e&&e.keyId!==r.keyId)continue}else if(r.certId){const e=i.getExtension(Ai);if(e&&(r.certId.serialNumber!==i.serialNumber||!a(nr.serialize(r.certId.name),nr.serialize(e))))continue}if(await e.verify({publicKey:await i.publicKey.export(t),signatureOnly:!0},t))return i}}return null}},e.cryptoProvider=Zi,e.diAlgorithm=Wn,e.diAlgorithmProvider=Yn,e.diAsnSignatureFormatter=os,e.idEd25519=fc,e.idEd448=yc,e.idX25519=pc,e.idX448=hc,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
