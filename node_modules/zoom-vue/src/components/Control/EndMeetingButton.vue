<template>
    <div>
        <v-dialog
            v-model="dialog" style="max-width:480px;">
            <template v-slot:activator="{ props }">
                <IconMeetingEnd v-bind="props" />
            </template>

            <v-card class="rounded-xl">
                <v-card-text>
                    <v-container>
                        <v-row>
                            <span class="text-h5">Leave Video Conference</span>
                        </v-row>
                        <v-row>
                            <span class="text-body-1">Do you want to leave video conference?</span>
                        </v-row>
                    </v-container>
                </v-card-text>
                <v-card-actions>
                    <v-container>
                        <v-row>
                            <v-col md="12" class="padding5">
                                <v-btn class="rounded-lg" variant="flat" block color="#B71C1C64" @click="onLeaveMeeting(false)">Leave</v-btn>
                            </v-col>
                        </v-row>
                        <v-row v-if="isHoster">
                            <v-col md="12" class="padding5">
                                <v-btn class="rounded-lg" variant="flat" block color="#B71C1C64" @click="onLeaveMeeting(true)">End Video Conference</v-btn>
                            </v-col>
                        </v-row>
                        <v-row>
                            <v-col md="12" class="padding5">
                                <v-btn class="rounded-lg" variant="flat" block color="secondary" @click="dialog = false">Cancel</v-btn>
                            </v-col>
                        </v-row>
                    </v-container>
                   
                    
                </v-card-actions>
            </v-card>
            </v-dialog>
    </div>
</template>
<script>
import ZoomController from '../../ZoomController'
import IconMeetingEnd from '../Icon/IconMeetingEnd.vue'
const { ipcRenderer } = window.require('electron')
export default {
    components: {IconMeetingEnd},
    data(){
        return {
            isHost: false,
            dialog: false,
        }
    },
    computed:{
        isHoster(){
            return ZoomController.zoomClient.isHost()
        }
    },
    mounted(){
        ipcRenderer.on("onUserCloseWindow", this.onUserRequestCloseWindow)
    },
    methods:{
        async onLeaveMeeting(isEnd){
            this.dialog = false
            let result = await ZoomController.endConference(isEnd)
            if(result){
                ipcRenderer.send("onLeaveMeeting")
            }
        },
        onUserRequestCloseWindow(){
            if(ZoomController.zoomClient.getSessionInfo()?.isInMeeting){
                this.dialog = true
            }else{
                ipcRenderer.send("onLeaveMeeting")
            }
        }
    }
}
</script>
<style lang="scss" scoped>
    .padding5{
        padding: 5px !important;
    }
</style>