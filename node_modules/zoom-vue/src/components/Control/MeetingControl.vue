<template>
  <div class="main-control">
    <ul class="btn-group">
      <li>
        <MicrophoneButton />
      </li>
      <li>
        <CameraButton @onToastMessage="onToastMessage"/>
      </li>
      <li>
        <ShareScreenButton @onToastMessage="onToastMessage"/>
      </li>
      <li ref="reaction" @click="toggleReaction">
        <IconMeetingReaction />
      </li>
      <li>
        <EndMeetingButton />
      </li>
    </ul>
    <Transition>
      <div class="reaction-layer" v-if="isReactionLayerShown">
        <LayerReaction :parent="this" v-clickoutside="onCloseReaction" @onCloseReaction="onCloseReaction" :myselfInfo="myselfInfo" />
      </div>
    </Transition>
  </div>
</template>

<script>
import ZoomController from '../../ZoomController'
import IconMeetingReaction from '../Icon/IconMeetingReaction.vue'
import LayerReaction from './LayerReaction.vue'
import CameraButton from './CameraButton.vue'
import MicrophoneButton from './MicrophoneButton.vue'
import EndMeetingButton from './EndMeetingButton.vue'
import ShareScreenButton from './ShareScreenButton.vue'

import { isSupportWebCodecs } from '../../utils/platform'
export default {
    components: {
          IconMeetingReaction,
          LayerReaction,
          CameraButton,
          MicrophoneButton,
          EndMeetingButton,
          ShareScreenButton
    },
    props: ['isFocusWindow','myselfInfo'],
    emits: ["onToastMessage"],
    data () {
        return {
            audioType:'',
            isSettingLayerShown: false,
            isLowerThirdsLayerShown: false,
            isLeaveMeetingLayerShown: false,
            isShareLayerShown: false,
            isOtherUserSharing: false,
            isReactionLayerShown: false,
            isParticipantFeedbackBtnShown: false,
            appsList: [],
            monitorsList: [],
            moreBtnLeftPosition: '',
            totalSubmit: 0,
            reactionTipPosition: '',
            hasShownReactionTip: false,
            showShareScreenDialog: false,
            isSharingScreen: false,
        }
    },
    computed:{
      isUserShareScreen(){
        return this.$store.state.userShareScreen != null
      }
    },
    watch:{
      // isFocusWindow(val, oldVal){
      //   console.log("ddd")
      //   if(val){
      //     this.isReactionLayerShown = false
      //   }
      // }
    },
    mounted() {
      
    },
    unmounted() {
     
    },
    methods: {
      onClickOutSideReact(){
        this.isReactionLayerShown = false;
      },
      toggleReaction(){
        setTimeout(() => {
          this.isReactionLayerShown = !this.isReactionLayerShown;
        }, 100);
      },
      toggleSettingLayer(){
        //setTimeout(() => {
          this.isSettingLayerShown = !this.isSettingLayerShown
        //}, 100);
      },
      onCloseReaction(){
        this.isReactionLayerShown = false
      },
      onCloseSetting(){
        this.isSettingLayerShown = false
      },
      onToastMessage(message){
        this.$emit("onToastMessage", message)
      }
    }
}
</script>

<style lang="scss" scoped>
  .v-enter-active,
  .v-leave-active {
    transition: opacity 0.5s ease;
  }

  .v-enter-from,
  .v-leave-to {
    opacity: 0;
  }
  .main-control{
    width: 100%;
    height: 50px;
    position: absolute;
    bottom: 20px;
    display: flex;
    justify-content: center;
    .btn-group {
      height: 48px;
      left: 50%;
      bottom: 18px;
      transition: width 1s ease-in-out;
      li {
        float: left;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        margin: 0 10px;
        &:first-child {
          margin-left: 0;
        }
        &:last-child {
          margin-right: 0;
        }
      }
    }
  }
  .icon-setting {
    width: 48px;
    height: 48px;
    display: inline-block;
    position: absolute;
    bottom: 18px;
    right: 12px;
    cursor: pointer;
  }
  .control-layer {
    position: absolute;
    left: 50%;
    bottom: 90px;
    transform: translateX(-50%);
    z-index: 10;
  }
  .reaction-layer {
    position: absolute;
    left: calc(50% - 125px);
    bottom: 90px;
    z-index: 10;
  }
  .setting-layer {
    position: absolute;
    left: calc(50% - 155px);
    bottom: 90px;
    z-index: 10;
  }

  .reaction-tip {
    width: 283px;
    position: absolute;
    left: 50%;
    bottom: 50px;
    cursor: pointer;
  }
</style>
<style lang="scss">
  .meeting .btn-group {
    .meeting-participant {
      .el-badge__content {
        color: #747487;
        font-size: 10px;
        background: none;
        border: none;
        top: 11px;
        right: 15px;
        padding: 0;
      }
    }
    .meeting-submit {
      .el-badge__content {
        font-size: 10px;
        border: none;
        top: 6px;
        right: 10px;
        padding: 0 3px;
      }
    }
  }
</style>